Редактор и исполнитель скриптов с подстановкой данных

Программа предназначена для создания, редактирования и исполнения скриптов управляющих компьютером 
через графический интерфейс пользователя. Позволяет автоматизировать заполнение различных форм 
и выполнение других рутинных операций. 

Скрипты сохраняются в отдельных файлах с расширением .script
Данные для подстановки в формы хранятся в Excel таблице, каждое поле в ней представляет собой 
отдельный список данных, которые последовательно вставляются в указанных полях на экране.


Записываемые и воспроизводимые действия

Для мыши: 
- клик в указанных координатах;
- двойной клик в указанных координатах;
- клик правой клавишей в указанных координатах.

Для клавиатуры:
- нажатие клавиши;
- отпускание клавиши.


Общие настройки скрипта

Часть из них можно менять командами в скрипте:
- пауза между нажатием клавиш клавиатуры (после отпускания)
- пауза после клика мыши
- убеждаться, что нужный элемент (кнопка, иконка ...) присутствует в заданных координатах
- сколько раз следует повторить паузу в 1 секунду между поисками элемента, прежде чем искать по всему экрану
- производить поиск элемента на всем экране, если в нужных координатах он не найден или проверка отключена
- остановить выполнение скрипта при исключении 'no element'
- остановить выполнение скрипта при исключении 'no data'


Дополнения и возможности скрипта

- Любое действие в скрипте можно переместить, удалить или отредактировать вручную. 
- Действие можно добавить в любом месте вручную.
- После любого действия можно добавить паузу в секундах.
- в любом месте можно применить функцию вставки (через буфер обмена) данных
  из указанного поля таблицы с данными, данные из поля берутся по очереди.
- Можно организовать циклическое выполнение части скрипта заданное количество раз 
  или выполнить ее для каждого элемента указанного поля таблицы с данными.
- Можно выделить не выполняемый в обычной последовательности блок скрипта, 
  выполнение которого вызывается в любой части скрипта или при некоторых ошибках.


Команды скрипта

click left, x=x, y=y, image='name' - клик левой клавишей мыши
click right, x=x, y=y - клик правой клавишей мыши
double click, x=x, y=y, image='name' - двойной клик левой клавишей мыши

key down 'a' - нажать клавишу 'a'
key up 'a' - отпустить клавишу 'a'

pause n - пауза n (число) секунд

insert 'field_name' - вставить из буфера обмена очередной элемент из поля 'field_name' таблицы данных

next 'field_name' - перейти к следующему элементу поля 'field_name'

for 'field_name' - начало цикла блока столько раз, сколько элементов в поле 'field_name'
for n - начало цикла блока n (число) раз
end for - конец последнего объявленного цикла

block 'name' - начало блока скрипта с именем 'name' (блок не выполняется в последовательности команд)
end block - конец последнего объявленного блока скрипта, после него происходит возврат к месту вызова блока

anchor 'name' - метка в скрипте, куда может быть совершен переход

run 'name' - выполнить последовательность команд с именем (блока) с именем 'name' или переход к якорю 'name'
             посл блока происходит возврат к командам следующим за run

error 'no element': stop/ignore/name - реакция на ошибку 'no element': 
                    остановить скрипт/игнорировать/выполнить блок с указанным именем

error 'no data': stop/ignore/name - реакция на ошибку 'no element': 
                    остановить скрипт/игнорировать/выполнить блок с указанным именем

stop - остановить выполнение скрипта


Ошибки

Во время выполнения скрипта могут возникать ошибки. Реакция на них определена в скрипте 
и может изменяться командами скрипта по ходу выполнения.

- 'no element' - перед кликом по координатам программа пытается найти указанный элемент 
  (кнопку, иконку ...) в нужном месте экрана, если это не удается, программа ожидает 1 секунду, после 
  чего повторяет попытку. После нескольких попыток (количество указывается в настройке скрипта) 
  производится попытка поиска по всему экрану. В случае неудачи генерируется это исключение. Описанное 
  поведение задается настройками скрипта и может быть другим.

- 'no data' - возникает, когда программе не удается получить доступ к данным для подстановки. 
  Если отсутствует файл с данными, в файле нет поля указанного в скрипте, кончились элементы в поле.


Интерфейс и редактирование

Выбор скрипта.
В верхней части указано имя файла (скрипта) с которым происходит работа и текстовое описание.
Кнопки Создать, Открыть, Сохранить, Сохранить как... при нажатии на которые открывается окно 
работы с файлом.

Список команд скрипта.
Пронумерованные от 0 строки содержащие команды скрипта, каждая команда в отдельной строке.
Первая строка (с номером 0) всегда пустая.
В списке можно выделить строку или несколько строк с зажатой клавишей Shift или Ctrl.
Выбор строк приводит к изменению содержимого Редактора команд.
Над выбранными строками можно выполнять некоторые действия (описанные ниже).

Запись и воспроизведение
Блок кнопок для записи и воспроизведения скрипта.
- Запись - при нажатии кнопки сворачивается окно программы, ключается пауза 3 секунды, после чего звуковой сигнал
           сообщает, что запись начата (остановка записи клавишами CTRL+ESC или кнопкой стоп). Новые команды 
           записываются начиная с позиции, следующей за последней выделенной в списке.
- Стоп - останавливает запись (активируется когда запись включена).
- Выполнить - выполняет скрипт с позиции первой выбранной в списке и до последней выбранной (включительно). Если 
              выбрана одна строка, то выполнение скрипта начинается с нее и до конца, до команды block end или до 
              команды for end, конца цикла, если начала этого цикла не было встречено при выполнении. 
              Перед выполнением выдерживается пауза 3 секунды и звучит сигнал.

Редактор команд.
Представляет собой строку с выпадающим списком. В ней отображается команда выбранная в списке.
Ниже параметры этой команды в отдельных полях.
Если в списке выбрано несколько строк, то в выпадающем списке будет активна пустая строка, 
а из всего списка команд будут присутствовать только групповые команды: 
- for 'field_name' ... end for, 
- for n ... end for, 
- block 'name' ... end block
Если в списке выбрать другую команду - это не повлияет на содержимое списка, пока не будет нажата
нужная кнопка редактора.

Кнопки редактора.
- Сохранить - изменяет выбранную в списке команду на ту, что находится в редакторе.
- Вставить - вставляет команду из редактора в список, после текущей команды.

Для групповых операций, когда в списке выделены одна или несколько строк подряд, перед блоком ставится 
начало команды, после блока окончание. 
Для этих команд начало и конец выделенного группы определяется по первой и последней 
выделенным строкам, если между ними будут не выделенные строки - они попадут в группу.
Если группа содержит внутри себя начало блока (for или block) без окончания 
или конец блока (end for или end block) без начала - такая операия не выполнится (сообщит об ошибке).
Группа может входить в другую группу только целиком.

Редактор списка.
Включает несколько кнопок:
- Копировать - копирует одну или несколько выделенных строк из списка
- Вырезать - копирует и удаляет одну или несколько выделенных строк из списка
- Вставить - вставляет скопированные ранее строки за последней выделенной строкой
- Вставить с заменой - вставляет скопированные ранее строки заменяя ими строки выделенные в данный момент, 
                       если выделены строки не подряд то вставка не возможна
- Удалить - удаляет выделенные строки

История
- Назад - откат состояния списка перед последней выполненной операцией
- Вперед - активируется после нажатия клавиши назад и повторяет отмененные операции

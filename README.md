Редактор и исполнитель скриптов с подстановкой данных

Программа предназначена для создания, редактирования и исполнения скриптов управляющих компьютером 
через графический интерфейс пользователя. Позволяет автоматизировать заполнение различных форм 
и выполнение других рутинных операций. 


Формат данных

Скрипт - это папка с именем script, внутри которой файл script, без расширения, в текстовом формате. 
Он хранит настройки и команды скрипта. Формат файла описан в файле data_description.txt.
В папке также хранятся изображения элементов интерфейса (значки, иконки, кнопки) нужные для выпонения
скрипта. 
При сохранении скрипта папка упаковывается в ZIP архив с расширением .script. А при открытии в редакторе 
сохраняется в папке программы в распакованном виде.

Данные для подстановки в формы хранятся в Excel таблице, каждое поле в ней представляет собой 
отдельный список данных, которые последовательно вставляются в указанных полях на экране. Файл с данными 
должен находиться в одной папке с папкой script при выполнении скрипта. 
Соответственно когда пользователь указывает на файл с данными он копируется в папку с программой и 
удаляется после окончания работы со скриптом.


Записываемые и воспроизводимые действия

Для мыши: 
- клик в указанных координатах;
- двойной клик в указанных координатах;
- клик правой клавишей в указанных координатах.

Для клавиатуры:
- нажатие клавиши;
- отпускание клавиши.


Общие настройки скрипта

Часть из них можно менять командами в скрипте:
- пауза между нажатием клавиш клавиатуры (после отпускания)
- пауза после клика мыши
- пауза между командами
- убеждаться, что нужный элемент (кнопка, иконка ...) присутствует в заданных координатах
- сколько раз следует повторить паузу в 1 секунду между поисками элемента, прежде чем искать по всему экрану
- производить поиск элемента на всем экране, если в нужных координатах он не найден или проверка отключена
- действие, если элемент не найден: остановить/игнорировать/выполнить блок или перейти к якорю с указанным именем
- действие, если нет данных: остановить/игнорировать/выполнить блок или перейти к якорю с указанным именем


Дополнения и возможности скрипта

- Команды скрипта копируются, перемещаются, удаляются и редактируются вручную. 
- Команды добавляются в любом месте вручную.
- После любого действия можно добавить паузу в секундах.
- В любом месте можно применить функцию вставки данных из указанного поля или просто текста
- Можно организовать циклическое выполнение части скрипта заданное количество раз 
  или выполнить ее для каждого элемента указанного поля таблицы с данными.
- Можно выделить не выполняемый в обычной последовательности блок скрипта, 
  выполнение которого вызывается в любой части скрипта или при некоторых ошибках.
- Из любого места можно совершить переход в любое место скрипта
- Реакция на ошибки может быть настроена в самом скрипте


Команды скрипта

Клик левой клавишей мыши
Клик правой клавишей мыши
Двойной клик мыши 
Нажать клавишу n (n - название клавиши)
Отпустить клавишу n (n - название клавиши)
Пауза n секунд (n - целое число)
Вывести текст 'text'
Вывести данные из 'field_name'
Следующий элемент поля 'field_name' ('Поле таблицы (столбец) представлено в виде списка данных. Эта команда '
                'переводит указатель чтения к следующему элементу списка')
Цикл по полю 'field_name' (Начало блока команд, которые повторятся столько раз, сколько строк в указанном поле. 
                Окончание блока - команда Конец цикла)
Цикл n раз (n - число) (Начало блока команд, которые повторятся указанное в команде количество раз. 
                Окончание блока - команда Конец блока)
Конец цикла (Конец блока команд повторяющихся столько раз, сколько указано в начале блока, начатого командой Цикл.)
Блок 'name' (Поименованный блок команд который не выполняется в обычном порядке. Он вызывается командой 
            Выполнить или Ошибка. Блок завершается командой Конец блока. После чего скрипт выполняется от команды 
            вызвавшей блок.)
Конец блока (Завершение списка команд относящихся к последнему (перед этой командой) объявленному блоку. 
            Начало блока - команда Блок 'name'.)
Метка 'name' (Метка в скрипте, куда может быть совершен переход командами Выполнить или Ошибка.)
Выполнить 'name' (Выполняет блок или совершает переход к метке с указанным именем.)
Ошибка 'Нет элемента' (Меняет текущую реакцию скрипта на возникновение ошибки: 
            остановить скрипт/игнорировать/выполнить блок или перейти к якорю с указанным именем)
Ошибка 'Нет данных' (Меняет текущую реакцию скрипта на возникновение ошибки: 
            остановить скрипт/игнорировать/выполнить блок или перейти к якорю с указанным именем)
Стоп (Остановить выполнение скрипта)


Ошибки

Во время выполнения скрипта могут возникать ошибки. Реакция на них определена в скрипте 
и может изменяться командами скрипта по ходу выполнения.

- 'no element' - перед кликом по координатам программа пытается найти указанный элемент 
  (кнопку, иконку ...) в нужном месте экрана, если это не удается, программа ожидает 1 секунду, после 
  чего повторяет попытку. После нескольких попыток (количество указывается в настройке скрипта) 
  производится попытка поиска по всему экрану. В случае неудачи генерируется это исключение. Описанное 
  поведение задается настройками скрипта и может быть другим.

- 'no data' - возникает, когда программе не удается получить доступ к данным для подстановки. 
  Если отсутствует файл с данными, в файле нет поля указанного в скрипте, кончились элементы в поле.


Интерфейс и редактирование

Выбор скрипта.
В меню Файл:
пункты Создать, Открыть, Сохранить, Сохранить как... при нажатии на которые открывается окно 
работы с файлом.
Имя текущего файла (скрипта) и текстовое описание можно посмотреть в Настройках скрипта.

Выбор источника данных.
В меню Файл:
пункт Источник данных открывает окно выбора файла, в котором можно указать файл в формате excel из полей которого
будут сформированы словари. Имя поля - это ключ словаря, данные в строках присваиваются этому ключу в виде списка.
В верхней части окна Источник данных: текстовое поле с именами полей.

Настройки.
Пункт меню, которая откроет диалоговое окно с настройками скрипта. 
Тут указано имя текущего файла (скрипта) и текстовое описание. Общие настройки скрипта, которые описаны выше.
Настройки подгружаются из файла скрипта при его выборе. Или устанавливаются по умолчанию для нового скрипта.

Список команд скрипта.
Пронумерованные от 0 строки содержащие команды скрипта, каждая команда в отдельной строке.
Первая строка (с номером 0) всегда пустая.
В списке можно выделить строку или несколько строк с зажатой клавишей Shift или Ctrl.
Выбор строк приводит к изменению содержимого Редактора команд.
Над выбранными строками можно выполнять некоторые действия (описанные ниже).

Запись и воспроизведение
Блок кнопок для записи и воспроизведения скрипта.
- Запись - при нажатии кнопки сворачивается окно программы, ключается пауза 3 секунды, после чего звуковой сигнал
           сообщает, что запись начата (остановка записи клавишами CTRL+ESC или кнопкой стоп). Новые команды 
           записываются начиная с позиции, следующей за последней выделенной в списке.
- Стоп - останавливает запись (активируется когда запись включена).
- Выполнить - выполняет скрипт с позиции первой выбранной в списке и до последней выбранной (включительно). Если 
              выбрана одна строка, то выполнение скрипта начинается с нее и до конца. Встречаемые в скрипте 
              команды конца цикла или блока игнорируются, если не было начала.
              Перед выполнением выдерживается пауза 3 секунды и звучит сигнал.

Редактор команд.
Представляет собой строку с выпадающим списком. В ней отображается команда выбранная в списке.
Поле для ввода комментария позволят ввести название действия, при его наличии в списке отображается не 
команда, а введенный комментарий.
Ниже параметры этой команды в отдельных полях. Для команд мыши отображается картинка с элементом (кнопкой, иконкой..).
Если в списке выбрано несколько строк, то в выпадающем списке будет пустая строка.
Если в списке выбрать другую команду - это не повлияет на содержимое списка, пока не будет нажата
нужная кнопка редактора.

Кнопки редактора.
- Сохранить - изменяет выбранную в списке команду на ту, что находится в редакторе.
- Вставить - вставляет команду из редактора в список, после текущей команды.


Редактор списка.
Включает несколько кнопок:
- Копировать - копирует одну или несколько выделенных строк из списка
- Вырезать - копирует и удаляет одну или несколько выделенных строк из списка
- Вставить - вставляет скопированные ранее строки за последней выделенной строкой
- Удалить - удаляет выделенные строки, удаление команд где используется изображение не удаляет его.

История
- Назад - откат состояния списка перед последней выполненной операцией
- Вперед - активируется после нажатия клавиши назад и повторяет отмененные операции

Запуск программы
Для запуска программы нужно запустить файл main.py. 
Его можно запускать с параметрами:
main.py, main.py -c, main.py --code                            - Откроется окно быстрого запуска скрипта
main.py -m, main.py --manager                                  - Откроется окно менеджера проектов
main.py -e, main.py --editor                                   - Откроется окно редактора скриптов
main.py -r, main.py --run <путь к проекту> <имя файла данных>  - Запустит нужный скрипт
    Пример: main.py -r --run C:\Scripts\Script_1 data.xlsx 
    (путь и имя файла можно брать в кавычки если в них есть пробелы)
main.py -r, main.py --run <код проекта>                        - Запустит скрипт из рабочей папки
    Пример: main.py -r --run 0101 
    (коды можно посмотреть в менеджере проектов)

Режим разработчика
Можно включить или выключить в редакторе, меню Запуск скриптов.
В режиме разработчика открываются кнопки перехода в редактор и менеджер проектов
из окна быстрого запуска.

Доработки ----------------------------------------------------------------------
1. Поработать над алгоритмом распознавания картинок чтобы изменение яркости меньше влияло
2. Проверить влияние порога чувствительности распознавания, можно вынести в настройки
3. Добавить уменьшение размера значна (по периметру) с целью обрезки границ
4. Объединение в одну команду Нажатия и Отпускания одной кнопки и таких операций в команду
5. Изменить функцию сохранения ярлыка и его имя.
6. При переходе в другие окна из редактора предложить сохранить проект

# SWD.html

Script with data справка

# Описание программы

Программа "Script with data" представляет собой инструмент для [выполнения](<SWDhtml.md#h.eqb3rxq3rr27>) [скриптов ](<SWDhtml.md#h.2szjykw00q1e>)с [подстановкой данных](<SWDhtml.md#h.l3pq1gxzrq3n>). Она разработана для [записи](<SWDhtml.md#h.11in4ibg2tt7>) и [воспроизведения](<SWDhtml.md#h.eqb3rxq3rr27>) действий пользователя на компьютере, таких как перемещение мыши, клики мышью и нажатия клавиш клавиатуры.

Все действия пользователя записываются в виде [команд](<SWDhtml.md#h.mstyefmcfn3k>) для программы и могут быть [отредактированы](<SWDhtml.md#h.ktqitaev4i9m>) пользователем. Затем эти действия могут быть воспроизведены, позволяя компьютеру повторить все действия пользователя. Таким образом, программа позволяет автоматизировать выполнение рутинных задач, освобождая человека от их выполнения. Некоторые примеры использования включают отправку электронных писем, тестирование программ и другие подобные задачи.

## Состав программы

Программа состоит из 3 компонентов:

1. [Редактор скриптов](<SWDhtml.md#h.j1dgpsh8jo7q>) - отдельное окно, с помощью которого можно записать действия пользователя и преобразовать их в [список команд](<SWDhtml.md#h.wm04hscnt7xs>) (скрипт). Скрипт может быть набран в [ручном режиме](<SWDhtml.md#h.yuowigqqqbyt>), дополнен [вспомогательными командами](<SWDhtml.md#h.eo50ya2igvk5>) и настроен в соответствии с требованиями пользователя.
1. [Менеджер проектов](<SWDhtml.md#h.9wpp5pdgo4bi>) - окно, в котором отображаются [проекты](<SWDhtml.md#h.2szjykw00q1e>) из [рабочей папки](<SWDhtml.md#h.7ix3c5p2au58>). Тут проектам присваиваются и переназначаются пользователем уникальные (в рамках [рабочей папки](<SWDhtml.md#h.7ix3c5p2au58>)) [коды для запуска](<SWDhtml.md#h.5blu56l3kfbw>). Создаются[ штрих-коды](<SWDhtml.md#h.evj2gw5z4tgg>) и [ярлыки](<SWDhtml.md#h.ng9wuof2xvqd>) на рабочем столе для быстрого запуска.
1. [Окно быстрого запуска](<SWDhtml.md#h.y0smfg36xmvl>). Служит для [запуска скрипта](<SWDhtml.md#h.xjirkhrxnhoh>) из [рабочей папки](<SWDhtml.md#h.7ix3c5p2au58>) по [коду](<SWDhtml.md#h.5blu56l3kfbw>) или посредством сканера [штрих-кодов](<SWDhtml.md#h.5blu56l3kfbw>).

# Отличительные возможности программы

Script with data является мощным инструментом автоматизации рутинных задач на компьютере. В этом разделе мы рассмотрим отличительные функциональные возможности данной программы. Среди них:

* [Запись и сверка пиксельных изображений](<SWDhtml.md#h.uk1iihhutld4>): возможность записи изображений участков интерфейса приложений или веб-страниц позволяет программе решать проблему изменения внешнего вида интерфейса. [Сверка изображений](<SWDhtml.md#h.ignb65nsx6ic>) во время воспроизведения позволяет реагировать на изменения интерфейса для принятия решений о [выполнении действий](<SWDhtml.md#h.bx3kyijtt2se>).
* [Реакция на ошибки](<SWDhtml.md#h.bx3kyijtt2se>): программа обладает возможностью автоматического принятия решения на основе возникших ошибок.
* Вставка текстов в поля приложений или веб-страниц: данные для вставки могут быть [заранее записаны](<SWDhtml.md#h.4vvmlgd7sofq>) в скрипт или [взяты из табличных файлов](<SWDhtml.md#h.5rc65rfuton>).
* [Организация циклов](<SWDhtml.md#h.eo50ya2igvk5>): возможность организации циклов команд на основе [нужного количества повторений](<SWDhtml.md#h.rc4p2qf07zk2>) или [перебора записей файла](<SWDhtml.md#h.vbflfq8d55hy>).
* Переход по [меткам](<SWDhtml.md#h.za8bw83dekbe>): программа поддерживает возможность перехода по меткам, что улучшает управление скриптом.
* [Организация подпрограмм](<SWDhtml.md#h.cha4mq1bkwx3>): участок скрипта, который можно выполнить из разных частей программы.
* Гибкое [редактирование команд кликов мыши](<SWDhtml.md#h.mxcv7zt2wndj>): программа предоставляет гибкий механизм редактирования команд кликов мышки, что позволяет избегать ошибок при выполнении скрипта.
* Сокращение некоторых комбинаций клавиш в отдельные команды: программа позволяет сократить [некоторые комбинации клавиш](<SWDhtml.md#h.7jf61cy4vr68>) в [отдельные команды](<SWDhtml.md#h.wyv4cepnp9u>) для более эффективного управления.
* Работа с буфером обмена: программа поддерживает возможность работы с буфером обмена через [комбинации клавиш](<SWDhtml.md#h.7jf61cy4vr68>).
* Набор скрипта в редакторе: возможность полностью [набрать скрипт в редакторе](<SWDhtml.md#h.yuowigqqqbyt>) или [записать действия пользователя](<SWDhtml.md#h.11in4ibg2tt7>) с последующим редактированием.

# Основные понятия

## Проект и скрипт

Скрипт - это основное понятие, которым оперирует программа. Он представляет собой не просто набор команд, а включает в себя также [настройки](<SWDhtml.md#h.fdjt0djkiwh6>), [изображения элементов интерфейса](<SWDhtml.md#h.j8f16470akjv>) и [файлы с данными](<SWDhtml.md#h.l3pq1gxzrq3n>). В процессе [выполнения скрипта](<SWDhtml.md#h.eqb3rxq3rr27>) может использоваться один [источник данных](<SWDhtml.md#h.l3pq1gxzrq3n>) (файл) или не использоваться вовсе.

Однако в данной программе понятие "скрипт" почти не используется. Вместо этого используется понятие "проект".

[Проект](<SWDhtml.md#h.36qif94pqnq2>) представляет собой папку с определенным именем, имя папки - это и есть имя проекта. Внутри папки находится файл со скриптом и настройками, имеющий то же имя, что и папка, и расширение json. Также в ней есть две дополнительных папки: "[data](<SWDhtml.md#h.716kn8bneali>)", где хранятся [источники данных](<SWDhtml.md#h.l3pq1gxzrq3n>) для скрипта, файлы в формате xls, xlsx, csv, и "[elements\_img](<SWDhtml.md#h.mzwrxkgbzmtz>)", где хранятся [изображения элементов интерфейса](<SWDhtml.md#h.j8f16470akjv>).

Таким образом, скрипт является основным содержимым проекта, который включает в себя дополнительные [настройки](<SWDhtml.md#h.fdjt0djkiwh6>), [изображения элементов интерфейса](<SWDhtml.md#h.j8f16470akjv>) и [файлы с данными](<SWDhtml.md#h.l3pq1gxzrq3n>). Проект представляет собой единую структуру, облегчающую использование и управление скриптами в программе.

## Источник данных

Источник данных - это табличный файл в формате xls, xlsx или csv, который может быть [подключен](<SWDhtml.md#h.ql466eipl0ty>) к программе для предоставления текстовых данных. Эти данные используются для заполнения полей форм или других элементов интерфейса.

Механизм источника данных позволяет программе использовать один и тот же [скрипт](<SWDhtml.md#h.2szjykw00q1e>) с разными данными, не изменяя сам скрипт. Для этого в табличном документе первая строка должна содержать названия полей. Скрипт будет использовать эти названия для определения, из какого столбца брать данные. В процессе выполнения скрипта указатель будет перемещаться по строкам таблицы, чтобы показывать, из какой строки брать данные.

Переход по записям таблицы (перемещение указателя на следующую строку) может осуществляться автоматически в [цикле](<SWDhtml.md#h.zhc91ec0nwvs>) или с помощью [специальных команд](<SWDhtml.md#h.1dgy5msahlyx>). Положение указателей (для каждого поля свой) нигде явно не отображается.

Проект может содержать несколько источников данных, которые хранятся в папке "[data](<SWDhtml.md#h.716kn8bneali>)". Однако, к одному [скрипту](<SWDhtml.md#h.2szjykw00q1e>) может быть [подключен](<SWDhtml.md#h.ql466eipl0ty>) только один источник данных одновременно.

## Рабочая папка

Концепция рабочей папки в программе - это папка на диске, в которой хранятся [проекты](<SWDhtml.md#h.2szjykw00q1e>) программы. Программа хранит путь к [рабочей папке](<SWDhtml.md#h.3uert1ko6x0u>) в настройках. По умолчанию рабочей назначается папка программы, но пользователь может изменить место нахождения рабочей папки через [меню редактора](<SWDhtml.md#h.1ft0tukrlxr>) или [кнопкой](<SWDhtml.md#h.udfb96z2z0of>) в [менеджере проектов](<SWDhtml.md#h.9wpp5pdgo4bi>). Этот путь используется как путь по умолчанию при [открытии](<SWDhtml.md#h.z5o8v075jn1o>) и [сохранении проектов](<SWDhtml.md#h.w47td0be93lo>). А также как место, в котором программа ищет проект, когда для его запуска используется [цифровой код](<SWDhtml.md#h.5blu56l3kfbw>) или [штрих-код](<SWDhtml.md#h.5blu56l3kfbw>). Этим способом скрипт может быть запущен из [Окна быстрого запуска](<SWDhtml.md#h.y0smfg36xmvl>) или из [Менеджера проектов](<SWDhtml.md#h.9wpp5pdgo4bi>).

В рабочей папке [Менеджер проектов](<SWDhtml.md#h.9wpp5pdgo4bi>) автоматически создает файл “[projects\_list.json](<SWDhtml.md#h.kt2wg7wyaffc>)”, в котором хранит информацию обо всех [проектах](<SWDhtml.md#h.2szjykw00q1e>) в [папке](<SWDhtml.md#h.7ix3c5p2au58>) и назначает каждому проекту и файлу в проекте [уникальный код](<SWDhtml.md#h.5blu56l3kfbw>), комбинация которых и используется для [запуска скриптов](<SWDhtml.md#h.xjirkhrxnhoh>). Поэтому скрипт по коду может быть запущен из рабочей папки, только когда папка назначена таковой и [просканирована](<SWDhtml.md#h.kt2wg7wyaffc>) [Менеджером проектов](<SWDhtml.md#h.9wpp5pdgo4bi>).

## Код запуска. Штрих-код

Код запуска - это комбинация номера [проекта](<SWDhtml.md#h.2szjykw00q1e>) и номера [файла данных](<SWDhtml.md#h.l3pq1gxzrq3n>), которая служит для [запуска](<SWDhtml.md#h.xjirkhrxnhoh>) конкретного [скрипта](<SWDhtml.md#h.2szjykw00q1e>) с определенным [источником данных](<SWDhtml.md#h.l3pq1gxzrq3n>). Номера проектов и файлов состоят из двух цифр (от 01 до 99). Код запуска образуется из 2 пар, где первая пара обозначает номер [проекта](<SWDhtml.md#h.2szjykw00q1e>), а вторая - номер [файла данных](<SWDhtml.md#h.l3pq1gxzrq3n>). Если скрипту не требуется [источник данных](<SWDhtml.md#h.l3pq1gxzrq3n>), вместо номера файла добавляются нули.

Коды генерируются и назначаются проектам автоматически [Менеджером проектов](<SWDhtml.md#h.9wpp5pdgo4bi>), там же они могут быть [переназначены ](<SWDhtml.md#h.6wj4lmbtuld1>)пользователем.

С помощью кода скрипт может быть [запущен](<SWDhtml.md#h.xjirkhrxnhoh>) только из [рабочей папки](<SWDhtml.md#h.7ix3c5p2au58>) в [Окне быстрого запуска](<SWDhtml.md#h.y0smfg36xmvl>) или в [Менеджере проектов](<SWDhtml.md#h.9wpp5pdgo4bi>), где он вводится в [соответствующее поле](<SWDhtml.md#h.9yjp2fejt9da>).

Для ввода кода можно воспользоваться сканером штрих-кодов для сканирования [предварительно созданного](<SWDhtml.md#h.evj2gw5z4tgg>) штрих-кода. [Штрих-код](<SWDhtml.md#h.5blu56l3kfbw>) может быть сгенерирован и сохранен в указанном месте на диске с помощью кнопки [Получить штрих-код](<SWDhtml.md#h.evj2gw5z4tgg>) в [Менеджере проектов](<SWDhtml.md#h.9wpp5pdgo4bi>).

## Выполнение скрипта

Процесс, при котором программа выполняет заданный [скрипт](<SWDhtml.md#h.2szjykw00q1e>). Воспроизводятся [записанные действия пользователя](<SWDhtml.md#h.yoaa2fsvqqh4>), такие как нажатия клавиш, клики мыши. Кроме того выполняются другие вспомогательные [команды](<SWDhtml.md#h.mstyefmcfn3k>).

Скрипт выполняется до получения команды остановки от пользователя, записанной в [скрипте](<SWDhtml.md#h.3zt1iv2kyf03>) или пришедшей в результате завершения списка команд.

Скрипт может выполняться в разных режимах, в зависимости от компонента программы из которого [запускается](<SWDhtml.md#h.xjirkhrxnhoh>):

* в скрытом режиме - окно программы скрывается на время выполнения ([Окно быстрого запуска](<SWDhtml.md#h.y5mvv0jda82c>), [Менеджер проектов](<SWDhtml.md#h.b4bmyljfdiks>)). После выполнения появляется.
* в фоновом режиме - окно не появляется вообще (запуск скрипта [ярлыком](<SWDhtml.md#h.g8smhndqepbv>))
* в режиме редактирования - окно редактора не скрывается ([Редактор скриптов](<SWDhtml.md#h.qdx7l72slmw5>)).

Независимо от места запуска скрипта, пользователь может остановить его выполнение в любой момент дважды нажав левый Ctrl.

Выполнение скрипта может быть прервано диалоговым окном [Остановка скрипта для диалога](<SWDhtml.md#h.z2edftevu2ta>).

## Режим разработчика

Режим разработчика включается и выключается через основное меню в [Редакторе скриптов](<SWDhtml.md#h.j1dgpsh8jo7q>): [Опции](<SWDhtml.md#h.q59o4hbkap98>) -\> [Режим разработчика](<SWDhtml.md#h.myisy87g6y2d>).

В текущей версии программы опция влияет только на отображение [дополнительных кнопок ](<SWDhtml.md#h.ald3izvwampa>)в [Окне быстрого запуска](<SWDhtml.md#h.y0smfg36xmvl>).

## Изображения элементов интерфейса

Для выполнения [кликов мыши](<SWDhtml.md#h.m6nrr53w02>) и в команде [Проверка изображения](<SWDhtml.md#h.ignb65nsx6ic>) программа делает скриншоты участков экрана (кнопки, иконки, ярлыки) и сохраняет их в папку проекта "[elements\_img](<SWDhtml.md#h.uk1iihhutld4>)" (такая папка есть у всех [проектов](<SWDhtml.md#h.2szjykw00q1e>)). При [воспроизведении скрипта](<SWDhtml.md#h.eqb3rxq3rr27>) эти изображения используются для ориентации на экране, с этой целью выполняется [Проверка изображений](<SWDhtml.md#h.uk1iihhutld4>).

## Проверка изображений

Это один из ключевых механизмов программы, позволяющий ей ориентироваться в интерфейсах приложений с которыми она работает. Проверка изображений используется во всех командах [кликов мыши](<SWDhtml.md#h.m6nrr53w02>) и в одноименной команде [Проверка изображения](<SWDhtml.md#h.ignb65nsx6ic>).

Принцип работа механизма основан на [изображениях элементов интерфейса](<SWDhtml.md#h.j8f16470akjv>), которые программа [сохраняет](<SWDhtml.md#h.mzwrxkgbzmtz>) при [записи скрипта](<SWDhtml.md#h.11in4ibg2tt7>). Например, [клик мыши](<SWDhtml.md#h.m6nrr53w02>) по кнопке создает [команду](<SWDhtml.md#h.m6nrr53w02>) с координатами курсора в момент клика и фрагментом изображения этой кнопки, который записывается в [папку изображений проекта](<SWDhtml.md#h.mzwrxkgbzmtz>). При [воспроизведении](<SWDhtml.md#h.qdx7l72slmw5>), программа сравнит сохраненное изображение с местом на экране, куда должен быть совершен клик мышью и на основании [результата сравнения](<SWDhtml.md#h.bx3kyijtt2se>) примет решении о совершении этого или другого [действия](<SWDhtml.md#h.cbp6oij3yctx>).

Проверка изображений осуществляется по следующей [базовой схеме](<SWDhtml.md#h.fdjt0djkiwh6>):

1. Поиск имеющегося участка изображения на месте проверки с заданными координатами и размером.
1. Если элемент присутствует в области с заданными координатами, [совершается клик](<SWDhtml.md#h.m6nrr53w02>) или [иное действие](<SWDhtml.md#h.bx3kyijtt2se>) предусмотренное командой.
1. Если элемент не найден, проверка начинается сначала через 1 секунду. После 3 попыток выполняется следующий пункт.
1. Производится поиск [элемента](<SWDhtml.md#h.j8f16470akjv>) на всем экране, если он найден, [совершается клик](<SWDhtml.md#h.m6nrr53w02>) в координатах его местонахождения или выполняется [другое действие](<SWDhtml.md#h.bx3kyijtt2se>), основанное на информации о наличии искомого [изображения на экране](<SWDhtml.md#h.j8f16470akjv>).
1. Если [элемент](<SWDhtml.md#h.j8f16470akjv>) не найден, вырабатывается [ошибка изображения](<SWDhtml.md#h.bx3kyijtt2se>), на основании которой принимается решение о каком-либо действии.

Настройки такой проверки заданы по умолчанию для любого скрипта и описаны в разделе [Настройки скрипта](<SWDhtml.md#h.fdjt0djkiwh6>). Они могут быть изменены пользователем для любого скрипта через пункт меню [Настройки скрипта](<SWDhtml.md#h.w1nc25kgip7g>). Также доступны [локальные настройки](<SWDhtml.md#h.mxcv7zt2wndj>) схемы проверки для каждой команды использующей механизм проверки изображений.

## Реакция на ошибку

На обработке ошибок основан механизм принятия решений в программе. Применяемые решения позволяют контролировать ход [выполнения скрипта](<SWDhtml.md#h.eqb3rxq3rr27>).

Есть 2 типа ошибок которые контролируются программой:

* [Ошибки изображений](<SWDhtml.md#h.uk1iihhutld4>) - к ним относятся все ошибки возникающие при работе с [изображениями элементов интерфейса](<SWDhtml.md#h.j8f16470akjv>). Это отсутствие изображения в папке [проекта](<SWDhtml.md#h.2szjykw00q1e>) (такого быть не должно, но изображение можно удалить из [папки](<SWDhtml.md#h.mzwrxkgbzmtz>) вручную), отсутствие изображения элемента на экране при [проверке](<SWDhtml.md#h.uk1iihhutld4>). На контроле этой ошибки основан механизм [Проверка изображений](<SWDhtml.md#h.uk1iihhutld4>).
* Ошибки данных - это ошибки связанные с отсутствием данных в [источнике данных](<SWDhtml.md#h.l3pq1gxzrq3n>). С их помощью контролируется выполнение [циклов](<SWDhtml.md#h.vbflfq8d55hy>) основанных на получении данных из источника. И может быть построено ветвление скрипта, основанное на количестве элементов в полях таблицы.

В большинстве случаев ошибки обрабатывают команды, которые их генерируют. Для этого в их параметрах есть специальный виджет [Реакция на ошибку](<SWDhtml.md#h.cbp6oij3yctx>). В нем указывается что делать при возникновении ошибки:

* Остановить [выполнение скрипта](<SWDhtml.md#h.eqb3rxq3rr27>)
* Игнорировать ошибку
* Вывести [диалоговое окно](<SWDhtml.md#h.z2edftevu2ta>) для пользователя
* Перейти к [метке](<SWDhtml.md#h.za8bw83dekbe>) в скрипте. При этом выборе нужно указать [метку](<SWDhtml.md#h.za8bw83dekbe>).

Реакция на ошибки по умолчанию определена в [Настройках скрипта](<SWDhtml.md#h.fdjt0djkiwh6>). И может быть изменена в [локальных настройках](<SWDhtml.md#h.mxcv7zt2wndj>) отдельных команд и в скрипте, при выполнении, командами [Реакция на ошибку “Нет элемента”](<SWDhtml.md#h.6dpmgr1mcoj5>), [Реакция на ошибку “Нет данных"](<SWDhtml.md#h.ct7v5jmguwzt>).

К командам обрабатывающим ошибки относятся все команды [проверяющие изображение](<SWDhtml.md#h.uk1iihhutld4>). И команда [конца цикла](<SWDhtml.md#h.zhc91ec0nwvs>).\
Команда [Следующий элемент поля](<SWDhtml.md#h.1dgy5msahlyx>) может генерировать ошибку данных, при этом она не обрабатывает ошибку, она обрабатывается автоматически, в соответствии с [Настройками скрипта](<SWDhtml.md#h.fdjt0djkiwh6>).

## Остановка скрипта для диалога

Это диалоговое окно появляется при [выполнении скрипта](<SWDhtml.md#h.eqb3rxq3rr27>). Оно может быть вызвано командой скрипта [Диалоговое окно](<SWDhtml.md#h.ppneq2rzdkxn>) или как [Реакция на ошибку](<SWDhtml.md#h.bx3kyijtt2se>).

В окне выводится причина остановки выполнения скрипта и предлагаются варианты продолжения:

* Перейти к [метке](<SWDhtml.md#h.za8bw83dekbe>) или [блоку](<SWDhtml.md#h.cha4mq1bkwx3>) - можно выбрать метку и скрипт продолжит выполняться с нее.
* Перезапустить - скрипт начнет выполняться с начала.
* Остановить - выполнение скрипта будет остановлено.
* Продолжить - скрипт продолжит выполняться дальше.

С помощью диалогового окна разработчики скрипта может напомнить о необходимости выполнения каких-либо действий, без которых продолжение скрипта не возможно.

# Запуск программы

Для запуска программы нужно открыть файл main.exe. При открытии файла без параметров откроется [Окно быстрого запуска](<SWDhtml.md#h.y0smfg36xmvl>).

Для открытия других компонентов программы нужно использовать ключи:

**main.exe -c** или **main.exe --code** - откроется [Окно быстрого запуска](<SWDhtml.md#h.y0smfg36xmvl>)

**main.exe -m** или **main.exe --manager** - откроется окно [Менеджера проектов](<SWDhtml.md#h.9wpp5pdgo4bi>)

**main.exe -e** или **main.exe --editor** - откроется окно [Редактора скриптов](<SWDhtml.md#h.j1dgpsh8jo7q>)

При установке программы стандартным инсталлятором на рабочем столе автоматически создаются 3 ярлыка для запуска программы в разных режимах.

# Запуск скрипта

Готовый скрипт может быть [запущен](<SWDhtml.md#h.eqb3rxq3rr27>) несколькими способами:

1. в Редакторе скриптов кнопкой [Выполнить скрипт](<SWDhtml.md#h.3b6tyd3v7v6q>)
1. в [Окне быстрого запуска](<SWDhtml.md#h.y0smfg36xmvl>) нужно ввести код проекта в [поле ввода](<SWDhtml.md#h.c6qfyilvnwy5>) и с помощью клавиши Enter или кнопки [Выполнить скрипт](<SWDhtml.md#h.y5mvv0jda82c>) запустить скрипт. При вводе [кода](<SWDhtml.md#h.5blu56l3kfbw>) посредством сканера штрих-кодов скрипт запустится автоматически.
1. в [Менеджере проектов](<SWDhtml.md#h.9wpp5pdgo4bi>) нужно набрать [код](<SWDhtml.md#h.5blu56l3kfbw>) проекта в [поле Поиск](<SWDhtml.md#h.9yjp2fejt9da>) и запуск по коду и запустить скрипт клавишей Enter или кнопкой “Выполнить скрипт”. При вводе [кода](<SWDhtml.md#h.5blu56l3kfbw>) посредством сканера штрих-кодов скрипт запустится автоматически.
1. [ярлыком](<SWDhtml.md#h.g8smhndqepbv>) на рабочем столе.

## Параметры ярлыка для запуска скрипта

Можно создать 2 типа ярлыков. В обоих случаях используется ключ “**-r**” или **“--run**”, за которым следует 1 или 2 параметра.\
 Первый тип запускает скрипт из [рабочей папки](<SWDhtml.md#h.7ix3c5p2au58>), установленной в программе.

**main.exe -r**, **main.exe --run** \<[код проекта](<SWDhtml.md#h.5blu56l3kfbw>)\>

Пример: **main.exe -r --run 0101**

Если проекта с нужным [кодом](<SWDhtml.md#h.5blu56l3kfbw>) в [рабочей папке](<SWDhtml.md#h.7ix3c5p2au58>) не окажется, скрипт не [запустится](<SWDhtml.md#h.qdx7l72slmw5>).

Второй тип ярлыков запускает скрипт из любого места, в нем в качестве параметров нужно указать полный путь к [проекту](<SWDhtml.md#h.2szjykw00q1e>) и если нужно, вторым параметром имя [файла данных](<SWDhtml.md#h.l3pq1gxzrq3n>).

**main.exe -r** или **main.exe --run** \<путь к проекту\> \<имя файла данных\>

Пример: **main.exe --run C:\\Scripts\\Script\_1 data.xlsx**

(путь и имя файла можно брать в кавычки, если в них есть пробелы)

В программе предусмотрена возможность создания ярлыков на Рабочем столе из [Менеджера проектов](<SWDhtml.md#h.9wpp5pdgo4bi>) кнопкой [Сохранить ярлык на рабочем столе](<SWDhtml.md#h.ng9wuof2xvqd>). Она создает ярлыки второго типа.

# Редактор скриптов

Редактор [скриптов](<SWDhtml.md#h.2szjykw00q1e>) открывается с помощью соответствующего [ярлыка](<SWDhtml.md#h.ax7z9tsy2qi1>) на рабочем столе. Также он может быть вызван кнопками в [Менеджере проектов](<SWDhtml.md#h.8rww6oyg9207>) и в [Окне быстрого запуска](<SWDhtml.md#h.h99a5u3h9h1d>) (кнопка видна, когда включен [Режим разработчика](<SWDhtml.md#h.sjfh8tnyi8gw>)) или комбинацией клавиш Ctrl+E.

При открытии редактора загружается последний [проект](<SWDhtml.md#h.2szjykw00q1e>), который был [загружен](<SWDhtml.md#h.z5o8v075jn1o>) в редакторе до его закрытия. Если этот проект не доступен по каким-либо причинам или отсутствует файл, в котором хранится конфигурация редактора, то создается новый проект с именем “script\_\<n\>”, где вместо \<n\> первый свободный номер проекта с таким именем в [рабочей папке](<SWDhtml.md#h.7ix3c5p2au58>). Проект сохраняется сразу при создании в текущей рабочей папке. В дальнейшем, для сохранения изменений необходимо нажать [Сохранить проект](<SWDhtml.md#h.wufapc18s94f>) в меню [Проект](<SWDhtml.md#h.36qif94pqnq2>) или подтвердить сохранение при [закрытии окна редактора](<SWDhtml.md#h.p68wgsw4kg1i>).

## Окно Редактора скриптов

Окно разделено на 2 части. В левой части находится [Список команд скрипта](<SWDhtml.md#h.wm04hscnt7xs>). Под списком [кнопки](<SWDhtml.md#h.3b6tyd3v7v6q>) записи, воспроизведения и остановки этих действий. В правой части 4 раздела: [Источник данных](<SWDhtml.md#h.4xsve5gcuzgc>), [Редактор команд](<SWDhtml.md#h.ktqitaev4i9m>), [Редактор скрипта](<SWDhtml.md#h.hhmek068wsjk>), [Информация](<SWDhtml.md#h.tvffvpfyj58l>). Еще ниже 2 кнопки для управления [Историей редактирования](<SWDhtml.md#h.t2yh38r8nnhf>).

### Основное меню

#### Проект

##### Новый проект

Откроет окно Создание нового [проекта](<SWDhtml.md#h.2szjykw00q1e>), в котором нужно указать имя для нового проекта и папку, в которой он будет создан.

##### Открыть проект

Откроется окно выбора папки, нужно выбрать папку [проекта](<SWDhtml.md#h.2szjykw00q1e>), который необходимо открыть.

##### Сохранить проект

Производит запись изменений в текущий [проект](<SWDhtml.md#h.2szjykw00q1e>).

##### Сохранить проект как

Делает копию текущего [проекта](<SWDhtml.md#h.2szjykw00q1e>). Откроет окно Сохранить проект как, в котором нужно указать имя для нового проекта и папку, в которой он будет сохранен.

##### Переименовать проект

Откроет окно Новое имя [проекта](<SWDhtml.md#h.2szjykw00q1e>), в котором нужно указать новое имя для текущего проекта.

##### Удалить лишние изображения

Эта опция служит для очистки папки с [изображениями](<SWDhtml.md#h.j8f16470akjv>) текущего проекта от тех, которые в данный момент не используются [командами](<SWDhtml.md#h.mstyefmcfn3k>) скрипта.

##### Просмотр изображений

Откроет папку "elements\_img", в которой хранятся [изображения](<SWDhtml.md#h.j8f16470akjv>) для текущего [проекта](<SWDhtml.md#h.2szjykw00q1e>).

##### Выход

[Закроет окно редактора](<SWDhtml.md#h.p68wgsw4kg1i>) скриптов.

#### Данные

##### Подключить источник данных

Откроет диалоговое окно выбора файла (xls, xlsx, csv). Если файл будет выбран вне папки файлов данных текущего [проекта](<SWDhtml.md#h.2szjykw00q1e>), то он будет скопирован в проект и выбран как [источник данных](<SWDhtml.md#h.l3pq1gxzrq3n>), в разделе[ Источник данных](<SWDhtml.md#h.4xsve5gcuzgc>) появится список полей (столбцов) таблицы файла.

##### Сбросить источник данных

Устанавливает указатели всех полей [источника данных](<SWDhtml.md#h.l3pq1gxzrq3n>) на начало. Эта операция выполняется автоматически при каждом [старте скрипта](<SWDhtml.md#h.qdx7l72slmw5>), если выбрана соответствующая настройка в [Настройках скрипта](<SWDhtml.md#h.fdjt0djkiwh6>).

##### Отключить источник данных

Раздел [Источник данных](<SWDhtml.md#h.4xsve5gcuzgc>) будет очищен, скрипт не сможет получать данные из источника. При попытке получения данных будет возникать ошибка.

##### Открыть файл данных

Откроет файл текущего [источника данных](<SWDhtml.md#h.l3pq1gxzrq3n>) в редакторе для редактирования табличных документов (например, Excel). Если файл будет изменен, то, чтобы обновления появились в программе, его нужно будет [подключить](<SWDhtml.md#h.ql466eipl0ty>) повторно.

##### Открыть папку с данными

Откроет папку “data” текущего [проекта](<SWDhtml.md#h.2szjykw00q1e>), в которой хранятся его [источники данных](<SWDhtml.md#h.l3pq1gxzrq3n>).

#### Опции

##### Быстрый запуск

Откроет [Окно быстрого запуска](<SWDhtml.md#h.y0smfg36xmvl>)

##### Менеджер проектов

Откроет [Менеджер проектов](<SWDhtml.md#h.9wpp5pdgo4bi>)

##### Выбрать рабочую папку

Откроет диалоговое окно для выбора [папки](<SWDhtml.md#h.7ix3c5p2au58>). Настройка применяется для всей программы.

##### Открыть рабочую папку

Откроет текущую [рабочую папку](<SWDhtml.md#h.7ix3c5p2au58>)

##### Режим разработчика

Включен/Выключен. Включает или выключает [режим разработчика](<SWDhtml.md#h.sjfh8tnyi8gw>)

##### Свернуть окно при записи

Да/Нет. Устанавливает, сворачивать ли окно редактора при включении [Режима записи](<SWDhtml.md#h.11in4ibg2tt7>)

#### Настройки скрипта

Откроет окно, которое позволяет выбрать [настройки](<SWDhtml.md#h.fdjt0djkiwh6>) по умолчанию для текущего [скрипта](<SWDhtml.md#h.2szjykw00q1e>). Они могут меняться [командами](<SWDhtml.md#h.afqeyw1gv7ba>) скрипта в процессе [выполнения](<SWDhtml.md#h.qdx7l72slmw5>), но это не меняет [настроек](<SWDhtml.md#h.fdjt0djkiwh6>) по умолчанию.

#### Менеджер проектов

Откроет [Менеджер проекто](<SWDhtml.md#h.9wpp5pdgo4bi>)[в](<SWDhtml.md#h.v81kr8xc6wvb>).

### Список команд скрипта

Первая строка списка всегда остается пустой.

Список отображает все [команды](<SWDhtml.md#h.mstyefmcfn3k>) скрипта. У левой границы списка расположен номер команды, далее идет название команды или ее [псевдоним](<SWDhtml.md#h.v9rp1twl5mms>), заданный пользователем.

С помощью мыши в списке можно выбрать 1 команду или группу команд. Для выбора группы команд используются клавиши Ctrl и Shift.

Для списка команд работают сочетания клавиш для [редактирования скрипта](<SWDhtml.md#h.yuowigqqqbyt>), они описаны в разделе [Редактор скрипта](<SWDhtml.md#h.hhmek068wsjk>). Так же работает сочетание Ctrl+A для выбора всех строк в списке.

### Кнопки управления скриптом

Под [списком команд скрипта](<SWDhtml.md#h.wm04hscnt7xs>) расположены 3 кнопки для [записи](<SWDhtml.md#h.11in4ibg2tt7>), [воспроизведения](<SWDhtml.md#h.eqb3rxq3rr27>) скрипта и остановки этих операций.

* кнопка Запись скрипта - программа переходит в [Режим записи](<SWDhtml.md#h.11in4ibg2tt7>)
* кнопка Стоп - выходит из режимов записи и воспроизведения
* кнопка Выполнение скрипта - переходит в [Режим воспроизведения](<SWDhtml.md#h.qdx7l72slmw5>) скрипта.

### Источник данных

В разделе [Источник данных](<SWDhtml.md#h.l3pq1gxzrq3n>) перечисляются названия полей (столбцов) выбранного файла с данными. Если файл не выбран, то поле будет пустым.

### Редактор команд

В [Редакторе команд](<SWDhtml.md#h.5bjuxwas3ofb>) выводятся [параметры](<SWDhtml.md#h.o081ql8gmjgq>) для выбранной в [Списке команд скрипта](<SWDhtml.md#h.wm04hscnt7xs>) [команды](<SWDhtml.md#h.mstyefmcfn3k>). При этом, краткая справка по команде выводится в раздел [Информация](<SWDhtml.md#h.tvffvpfyj58l>). Изменения [полей](<SWDhtml.md#h.o081ql8gmjgq>) в редакторе не приводят к немедленному изменению команды в [списке](<SWDhtml.md#h.wm04hscnt7xs>). В редакторе производится работа с копией выбранной команды, поэтому все изменения будут применены после сохранения с использованием [кнопок](<SWDhtml.md#h.v9rp1twl5mms>) Добавить команду или Изменить команду. Если изменения не сохранены, то они будут потеряны при выборе другой команды.

В Редакторе команд есть [постоянные элементы](<SWDhtml.md#h.v9rp1twl5mms>) и [изменяемые](<SWDhtml.md#h.o081ql8gmjgq>). Изменяемые элементы служат для отображения и изменения параметров команды, которая выбрана в [Списке команд скрипта](<SWDhtml.md#h.wm04hscnt7xs>) (параметры команд и выводимые для них элементы описаны в разделе [Команды](<SWDhtml.md#h.mstyefmcfn3k>)).

#### Постоянные элементы:

* выпадающий список команд, в котором указано название редактируемой [команды](<SWDhtml.md#h.mstyefmcfn3k>). В нем можно выбрать или заменить текущую команду.
* поле Псевдоним под выпадающим списком команд. В нем можно указать описание (псевдоним) для редактируемой команды, оно будет отображаться в [Списке команд скрипта](<SWDhtml.md#h.wm04hscnt7xs>) для этой команды, вместо ее названия.
* кнопка Добавить команду - добавляет редактируемую [команду](<SWDhtml.md#h.mstyefmcfn3k>) в [Список команд скрипта](<SWDhtml.md#h.wm04hscnt7xs>) после выделенной команды, при этом в списке выделяется новая команда.
* кнопка “Изменить команду” - применяет изменения для выделенной в [Списке команд скрипта](<SWDhtml.md#h.wm04hscnt7xs>) команде.

#### Изменяемые элементы. Параметры команд

Передача параметров [командам](<SWDhtml.md#h.mstyefmcfn3k>) осуществляется несколькими типами элементов. В этом разделе описаны элементы интерфейса и способы ввода данных в них. Информация о том, какие данные требуется команде выводится в разделе [Информация](<SWDhtml.md#h.tvffvpfyj58l>) при выборе команды в редакторе и описана в разделе [Команды](<SWDhtml.md#h.mstyefmcfn3k>) этого руководства.

##### Целое число

Обычное поле для ввода. Позволяет вводить только цифры с клавиатуры. Может иметь ограничение по количеству цифр и максимальному числу.

##### Строка

Обычное поле для ввода. Позволяет вводить любые символы с клавиатуры. Может иметь ограничение по количеству символов.

##### Дробное число

Или число с плавающей точкой. Поле принимает только цифры и символ разделителя (запятая или точка). Может иметь ограничение по количеству символов.

##### Выпадающий список

Нужно выбрать один один вариант из предложенного списка.

##### Реакция на ошибку

Это комбинированный виджет, позволяющий указать что делать в случае возникновения ошибки. Он состоит из 2 выпадающих списков. В первом нужно указать [реакцию на ошибку](<SWDhtml.md#h.bx3kyijtt2se>) из списка: “stop”, “ignore”, “dialog”, “run”. Второй активируется только когда в первом поле установлено значение “run” и позволяет указать название [метки](<SWDhtml.md#h.za8bw83dekbe>) к которой нужно [перейти](<SWDhtml.md#h.k29n479n7nig>) скрипту.

##### Выбор изображения

Элемент для выбора [изображения](<SWDhtml.md#h.j8f16470akjv>) состоит из поля с изображением и 2 кнопок под ним. В поле выводится выбранное изображение или символ, сообщающий о его отсутствии.

Клик по полю открывает диалоговое окно позволяющее выбрать изображение в формате “png”. Диалоговое окно открывается на папке с изображениями текущего проекта "[elements\_img](<SWDhtml.md#h.mzwrxkgbzmtz>)", но позволяет выбрать [изображение](<SWDhtml.md#h.j8f16470akjv>) и из другой папки, тогда оно будет скопировано в папку [проекта](<SWDhtml.md#h.2szjykw00q1e>). Выбранное изображение отобразится на поле.

Для удаления изображения используется кнопка Удалить изображение (справа под полем). Она открепляет изображение от команды, но не удаляет его физически. Для полного удаления из папки, после открепления изображения, нужно сохранить команду (если она ранее была сохранена с изображением), после чего [Удалить лишние изображения](<SWDhtml.md#h.wr9m92w2tzi>).

Левая кнопка под полем называется Скриншот, она позволяет получить изображение участка экрана и сохраняет его в папку изображений проекта.

###### *Инструкция для получения изображения участка экрана*

После нажатия кнопки Скриншот активируется режим, при котором работают только клавиши Ctrl.

Нажатие правого Ctrl запоминает [координаты](<SWDhtml.md#h.m6nrr53w02>) центра участка экрана с которого нужно получить [изображение](<SWDhtml.md#h.j8f16470akjv>). Поэтому после первого нажатия Ctrl курсор можно увести от элемента, если он меняет свой стиль при наведении мыши и это мешает получить изображение в изначальном виде.

Повторное нажатие этой клавиши делает скриншот и записывает его в нужную папку. При этом оно будет проверено на уникальность и если такое изображение уже есть в папке, сохранено не будет.

*Обратите внимание. Перед получением скриншота желательно удалить из [папки*](<SWDhtml.md#h.mzwrxkgbzmtz>) *с изображениями неиспользуемые, чтобы новое изображение не совпало с похожим, уже имеющемся, что не позволит заменить старое. Для этого нужно использовать команду [*Удалить лишние изображения](<SWDhtml.md#h.wr9m92w2tzi>) *в меню [Проект*](<SWDhtml.md#h.36qif94pqnq2>)*. Если неудачное изображение используется [командами*](<SWDhtml.md#h.mstyefmcfn3k>)*, его следует удалить из них чтобы оно удалилось из папки этой командой.*

Выход из режима получения скриншота осуществляется двойным нажатием левого Ctrl.

Если нужно получить только [координаты](<SWDhtml.md#h.m6nrr53w02>), а [изображение](<SWDhtml.md#h.j8f16470akjv>) не нужно (координаты будут записаны в соответствующие [поля](<SWDhtml.md#h.o081ql8gmjgq>) редактора команды), то после нажатия правого Ctrl первый раз следует нажать 3 раза подряд левый Ctrl.

##### Кнопка ЕЩЕ

Открывает окно Дополнительных настроек команды. В нем можно активировать локальные настройки, которые заменят при [воспроизведение скрипта](<SWDhtml.md#h.eqb3rxq3rr27>) действия основных [Настроек скрипта](<SWDhtml.md#h.fdjt0djkiwh6>). Эти настройки в данной версии программы применяются для изображений и используются всеми командами [клика мыши](<SWDhtml.md#h.m6nrr53w02>) и командой [Проверка изображения](<SWDhtml.md#h.ignb65nsx6ic>). Они включают в себя индивидуальные настройки для [опций](<SWDhtml.md#h.fdjt0djkiwh6>):

* Включить локальную проверку
* Зона локальной проверки
* Сколько секунд ждать, после 1 попытки
* Искать на всем экране
* Выполнить [действие](<SWDhtml.md#h.bx3kyijtt2se>) если изображение …
* Какое действие выполнить
* [Сообщение](<SWDhtml.md#h.z2edftevu2ta>) при выполнении действия

Описание опций можно посмотреть в разделе [Настройки скрипта](<SWDhtml.md#h.fdjt0djkiwh6>). В этом списке присутствует только один пункт, не применяемый в основных настройках, это Выполнить действие если изображение …. Он позволяет инвертировать значение нахождения изображения. Другими словами, [действие](<SWDhtml.md#h.bx3kyijtt2se>) выполняется, если [изображение](<SWDhtml.md#h.j8f16470akjv>) не найдено, как это и предусмотрено в [основных настройках](<SWDhtml.md#h.fdjt0djkiwh6>). Но можно выбрать и обратное, действие будет выполнено, если изображение будет найдено. Т.е. что считать ошибкой, присутствие или отсутствие изображения.

### Редактор скрипта

В этом разделе несколько кнопок позволяющие управлять [командами](<SWDhtml.md#h.mstyefmcfn3k>) [скрипта](<SWDhtml.md#h.2szjykw00q1e>). Для выполнения какой-либо операций нужно выделить в [Списке команд скрипта](<SWDhtml.md#h.wm04hscnt7xs>) одну или несколько команд, а затем нажать на соответствующую кнопку. Нажатие кнопки выведет сообщение в раздел [Информация](<SWDhtml.md#h.tvffvpfyj58l>) о выполненном действии. А результаты операции будут отображены в [Списке команд скрипта](<SWDhtml.md#h.wm04hscnt7xs>).

Следует учитывать, что при выборе нескольких команд идущих не подряд при операциях перемещения или вставки они будут вставлены подряд, одна за другой, даже если в месте откуда они копируются между ними были другие команды.

Операции выполняемые кнопками также могут быть активированы сочетаниями клавиш, они указаны в списке рядом с названиями кнопок:

* кнопка Сдвинуть вверх (Ctrl+Up) - переместит выделенную команду или группу команд на 1 строку вверх
* кнопка Копировать команды (Ctrl+C) - запомнит выделенные команды, сообщит об этом в разделе [Информация](<SWDhtml.md#h.tvffvpfyj58l>) и будет ждать нажатия кнопки Вставить команды для завершения операции копирования
* кнопка Переместить команды (Ctrl+X) - запомнит выделенные команды, сообщит об этом в разделе [Информация](<SWDhtml.md#h.tvffvpfyj58l>) и будет ждать нажатия кнопки Вставить команды для завершения операции перемещения
* кнопка Сдвинуть вниз (Ctrl+Down) - переместит выделенную команду или группу команд на 1 строку вниз
* кнопка Вставить команды (Ctrl+V) - завершает операции копирования и перемещения, вставляя запомненные команды после выделенной строки
* кнопка Удалить команды (Del) - удаляет выделенные команды

### Информация

В разделе информация выводятся различные справочные сообщения, сообщения о начале или завершении каких-то действий, информация о ходе [выполнения скрипта](<SWDhtml.md#h.qdx7l72slmw5>), [ошибки](<SWDhtml.md#h.bx3kyijtt2se>) и другие сведения позволяющие понимать состояние [редактора](<SWDhtml.md#h.j1dgpsh8jo7q>). Сообщения выводятся разными цветами в зависимости от их важности.

### Кнопки управления историей

Кнопки Отменить и Вернуть позволяют отменить выполненные действия и вернуть их, если отмена сделана ошибочно или не привела к ожидаемому результату. История может хранить до 100 действий. Она хранится только при работе программы и не сохраняется на диск.

### Закрытие окна редактора

При закрытии окна редактора или при переходе к другому [компоненту программы](<SWDhtml.md#h.vzcd0vu5cb74>) может появиться сообщение о необходимости [сохранить](<SWDhtml.md#h.wufapc18s94f>) изменения. Пользователь может подтвердить сохранение изменений, отказаться от них или остаться в [редакторе](<SWDhtml.md#h.j1dgpsh8jo7q>), нажав кнопку Отмена в диалоговом окне.

## Режим записи

Режим записи активируется нажатием [кнопки Запись скрипта](<SWDhtml.md#h.3b6tyd3v7v6q>) расположенной под [Списком команд скрипта](<SWDhtml.md#h.wm04hscnt7xs>). В разделе [Информация](<SWDhtml.md#h.tvffvpfyj58l>) появляется надпись Идет запись.

Если в меню [Опции](<SWDhtml.md#h.q59o4hbkap98>) в пункте [Свернуть окно при записи](<SWDhtml.md#h.40c54wqv4aav>) установлено “Да”, то окно при начале записи будет свернуто автоматически. В любом варианте элементы окна [редактора](<SWDhtml.md#h.j1dgpsh8jo7q>) в этом режиме не работают.

Для завершения записи можно воспользоваться [клавишей Стоп](<SWDhtml.md#h.3b6tyd3v7v6q>), расположенной рядом с [клавишей Запись скрипта](<SWDhtml.md#h.3b6tyd3v7v6q>) в окне редактора или дважды нажать левый Ctrl.

В режиме записи происходит фиксирование [действий](<SWDhtml.md#h.yoaa2fsvqqh4>) пользователя с мышью и клавиатурой и запись их в виде команд в [Список команд скрипта](<SWDhtml.md#h.wm04hscnt7xs>). Кроме того, для команды [Проверка изображения](<SWDhtml.md#h.ignb65nsx6ic>) и всех [кликов](<SWDhtml.md#h.m6nrr53w02>) мыши в папку проекта "[elements\_img](<SWDhtml.md#h.mzwrxkgbzmtz>)" записываются [изображения элементов интерфейса](<SWDhtml.md#h.j8f16470akjv>), на которых произведен клик, для дальнейшей проверки при [воспроизведении скрипта](<SWDhtml.md#h.qdx7l72slmw5>).

[Команды](<SWDhtml.md#h.mstyefmcfn3k>) записываются в строку, следующую за выделенной в [Списке команд скрипта](<SWDhtml.md#h.wm04hscnt7xs>). После записи каждой команды она автоматически выделяется.

### Как записываются действия?

Несмотря на то, что полный [список команд скрипта](<SWDhtml.md#h.mstyefmcfn3k>) достаточно обширный, основные команды фиксирующие [действия](<SWDhtml.md#h.yoaa2fsvqqh4>) клавиатуры и мыши не многочисленны.

Нажатие клавиши на клавиатуре записывается двумя командами: [Нажать клавишу](<SWDhtml.md#h.iv212hv8f99b>), [Отпустить клавишу](<SWDhtml.md#h.w1lscdo7x4bb>). В [параметрах](<SWDhtml.md#h.ktqitaev4i9m>) этой команды указывается название клавиши.

[Клик](<SWDhtml.md#h.m6nrr53w02>) мышью записывается одной из 3 команд: [Клик левой кнопкой мыши](<SWDhtml.md#h.m6nrr53w02>), [Двойной щелчок мышью](<SWDhtml.md#h.esis6drtmphb>), [Клик правой кнопкой мыши](<SWDhtml.md#h.zha9yik80atq>). В [параметрах](<SWDhtml.md#h.ktqitaev4i9m>) команд указываются координаты щелчка и [изображение участка экрана](<SWDhtml.md#h.j8f16470akjv>) на котором был произведен щелчок.

Полный перечень команд приведен в разделе [Команды](<SWDhtml.md#h.mstyefmcfn3k>).

### Специальные клавиши при записи

Для ввода отдельных команд используются стандартные комбинации клавиш или отдельные последовательности. Важно помнить, что для ввода комбинации клавиш первой должна быть нажата специальная клавиша (Ctrl, Shift, Alt, Win), затем буквенная клавиша. Порядок отпускания - не важен.

#### Стандартные сочетания клавиш:

* Ctrl+C - копировать в буфер обмена. Добавляет команду [Копировать](<SWDhtml.md#h.wyv4cepnp9u>)
* Ctrl+X - вырезать в буфер обмена. Добавляет команду [Вырезать](<SWDhtml.md#h.wyv4cepnp9u>)
* Ctrl+V - вставить из буфера обмена. Добавляет команду [Вставить](<SWDhtml.md#h.wyv4cepnp9u>)
* Ctrl+A - выделить все. Добавляет команду [Выделить все](<SWDhtml.md#h.wyv4cepnp9u>)
* Alt+Shift - переключить раскладку клавиатуры. Добавляет команду [Сменить язык](<SWDhtml.md#h.wyv4cepnp9u>)
* Ctrl+T - новая вкладка. Добавляет команду [Новая вкладка](<SWDhtml.md#h.wyv4cepnp9u>)
* Ctrl+Tab - новая вкладка. Добавляет команду [Следующая вкладка](<SWDhtml.md#h.wyv4cepnp9u>)
* Alt+Tab - следующее окно. Добавляет команду [Следующее окно](<SWDhtml.md#h.wyv4cepnp9u>)
* Win+D (Ctrl+Alt+D для Linux) - свернуть все окна. Добавляет команду [Свернуть все окна](<SWDhtml.md#h.wyv4cepnp9u>)

#### Клавиши для ввода команд:

* Ctrl (левый), Ctrl (левый) нажатие левой клавиши Ctrl подряд 2 раза - команду не вводит, останавливает [запись скрипта](<SWDhtml.md#h.11in4ibg2tt7>).
* Ctrl (правый), Ctrl (правый) нажатие правой клавиши Ctrl подряд 2 раза - добавляет команду [Проверка изображения](<SWDhtml.md#h.ignb65nsx6ic>).

## Ручной ввод и редактирование команд

Для более тонкой настройки [скрипта](<SWDhtml.md#h.2szjykw00q1e>) можно воспользоваться ручным вводом [команд](<SWDhtml.md#h.mstyefmcfn3k>) или отредактировать и дополнить команды после [записи](<SWDhtml.md#h.11in4ibg2tt7>).

Такая настройка позволит определить [паузы](<SWDhtml.md#h.xhxput4d009i>) в различных местах скрипта, [циклы](<SWDhtml.md#h.rc4p2qf07zk2>), [реакцию на ошибки](<SWDhtml.md#h.bx3kyijtt2se>) и др. Что позволит сократить объем скрипта, сделать его более универсальным, устойчивым к непредвиденным задержкам и ошибкам, предусмотреть варианты альтернативных действий в неожиданных ситуациях.

Редактирование команды происходит в [Редакторе команд](<SWDhtml.md#h.ktqitaev4i9m>). В нем можно задать [дополнительные настройки](<SWDhtml.md#h.mxcv7zt2wndj>) для существующей команды или создать новую команду и вставить ее в любое место скрипта.

Список команд с описанием параметров для их настройки можно найти в разделе [Команды](<SWDhtml.md#h.mstyefmcfn3k>).

### Что можно настроить и изменить в командах и скрипте?

Чтобы понимать какие возможности предоставляет программа в базовом варианте прямой записи действий можно ознакомиться с разделом [Режим записи](<SWDhtml.md#h.11in4ibg2tt7>). Он работает с настройками скрипта по умолчанию, описанному в разделе [Настройки скрипта](<SWDhtml.md#h.fdjt0djkiwh6>). И использует базовую схему [проверки изображений](<SWDhtml.md#h.uk1iihhutld4>).

Для настройки команд и дополнения скрипта доступны следующие возможности:

* изменить названия команд в списке на [псевдонимы](<SWDhtml.md#h.v9rp1twl5mms>)
* установить [задержки](<SWDhtml.md#h.fdjt0djkiwh6>) при исполнении команд, нажатий клавиш, кликов мыши.
* изменить базовую схему [проверки изображений](<SWDhtml.md#h.uk1iihhutld4>), применив [локальные настройки](<SWDhtml.md#h.mxcv7zt2wndj>).
* выбирать действия которые нужно выполнить при возникновении [ошибок](<SWDhtml.md#h.bx3kyijtt2se>) с изображением или данными.
* организовать выполнение действия в зависимости от наличия или отсутствия [изображения](<SWDhtml.md#h.ignb65nsx6ic>) в заданном месте экрана или на всем экране.
* вывести [диалоговое окно](<SWDhtml.md#h.z2edftevu2ta>) с сообщением пользователю и возможностью выбрать дальнейший вариант действий.
* вывести текст в место где находится фокус (куда установлен курсор). [Текст](<SWDhtml.md#h.4vvmlgd7sofq>) может быть задан заранее или взят из [Источника данных](<SWDhtml.md#h.5rc65rfuton>).
* подключить [источник данных](<SWDhtml.md#h.l3pq1gxzrq3n>).
* [переходить](<SWDhtml.md#h.1dgy5msahlyx>) по записям источника данных.
* организовать [повторное выполнение](<SWDhtml.md#h.rc4p2qf07zk2>) участка скрипта заданное количество раз. Или принимать решение о повторе на основе доступных данных в [Источнике данных](<SWDhtml.md#h.vbflfq8d55hy>).
* выделить участок скрипта в [отдельный блок](<SWDhtml.md#h.cha4mq1bkwx3>) и вызывать его исполнение из разных мест скрипта.
* поставить [метку](<SWDhtml.md#h.za8bw83dekbe>) в любом месте скрипта с целью [перехода](<SWDhtml.md#h.k29n479n7nig>) к ней в результате возникновения [ошибок](<SWDhtml.md#h.bx3kyijtt2se>), по желанию пользователя из [диалогового окна](<SWDhtml.md#h.z2edftevu2ta>) или без условий.
* сделать [паузу](<SWDhtml.md#h.xhxput4d009i>) или [остановить](<SWDhtml.md#h.3zt1iv2kyf03>) [выполнение скрипта](<SWDhtml.md#h.eqb3rxq3rr27>) в любом месте.

## Настройки скрипта

Настройки для всего [скрипта](<SWDhtml.md#h.2szjykw00q1e>) задаются в отдельном окне программы вызываемом пунктом меню [Настройки скрипта](<SWDhtml.md#h.w1nc25kgip7g>). Частично они могут быть [переопределены](<SWDhtml.md#h.mxcv7zt2wndj>) отдельными [командами](<SWDhtml.md#h.mstyefmcfn3k>) при [ручном редактировании](<SWDhtml.md#h.yuowigqqqbyt>) или во время [выполнения](<SWDhtml.md#h.qdx7l72slmw5>) скрипта. Применение локальных настроек не меняет состояние этих, они могут быть изменены только в окне настроек.

В списке описаны настройки и возможности их переопределения:

* Пауза между нажатием клавиш клавиатуры - задается [числом с плавающей точкой](<SWDhtml.md#h.z7hwqgyyka0f>) только в окне настроек.
* Пауза после [клика](<SWDhtml.md#h.m6nrr53w02>) мыши - задается [числом с плавающей точкой](<SWDhtml.md#h.z7hwqgyyka0f>) только в окне настроек.
* Пауза между [командами](<SWDhtml.md#h.mstyefmcfn3k>) (всеми) - задается [числом с плавающей точкой](<SWDhtml.md#h.z7hwqgyyka0f>) только в окне настроек.
* Сбрасывать источник данных при [запуске скрипта](<SWDhtml.md#h.qdx7l72slmw5>) - при установленном флажке выполняется команда как через меню [Данные](<SWDhtml.md#h.9obod49zabro>) - [Сбросить источник данных](<SWDhtml.md#h.cfix4p3yv4b>) каждый раз когда запускается скрипт, это позволяет при каждом [выполнении скрипта](<SWDhtml.md#h.eqb3rxq3rr27>) использовать данные из [источника](<SWDhtml.md#h.l3pq1gxzrq3n>) сначала.
- Включить локальную проверку - относится к схеме [проверки изображений](<SWDhtml.md#h.uk1iihhutld4>), может быть изменена в [локальных настройках](<SWDhtml.md#h.mxcv7zt2wndj>) команды. Определяет, нужно ли выполнить поиск изображения в области, размер которой задан настройкой [Зона локальной проверки](<SWDhtml.md#id.2iq28hz51nxb>) (сторона квадрата), при [выполнении скрипта](<SWDhtml.md#h.eqb3rxq3rr27>).
* Зона локальной проверки (сторона квадрата) -  относится к схеме [проверки изображений](<SWDhtml.md#h.uk1iihhutld4>), может быть изменена в [локальных настройках](<SWDhtml.md#h.mxcv7zt2wndj>) команды. Определяет размер квадрата в пикселях, в котором будет производиться поиск [изображения элемента](<SWDhtml.md#h.j8f16470akjv>) если включена проверка в настройке [Включить локальную проверку](<SWDhtml.md#id.gpsk9z469u0>).
* Сколько секунд ждать, после 1 попытки - относится к схеме [проверки изображений](<SWDhtml.md#h.uk1iihhutld4>), может быть изменена в [локальных настройках](<SWDhtml.md#h.mxcv7zt2wndj>) команды. Если первая попытка проверки изображения в [зоне локальной проверки](<SWDhtml.md#id.2iq28hz51nxb>) показала, что оно отсутствует, будут предприняты еще попытки поиска в этой зоне, каждая, через 1 секунду. Изображение могло не прогрузиться, по причине, например, медленного интернета. Эта опция показывает, сколько попыток всего нужно совершить, а следовательно, сколько секунд будет ожидание появления изображения.
* Искать на всем экране - относится к схеме [проверки изображений](<SWDhtml.md#h.uk1iihhutld4>), может быть изменена в [локальных настройках](<SWDhtml.md#h.mxcv7zt2wndj>) команды. Включение этой опции заставит программу искать [изображение](<SWDhtml.md#h.j8f16470akjv>) на всем экране, если ожидание изображения в [зоне локальной проверки](<SWDhtml.md#id.2iq28hz51nxb>) не принесло результата. Если изображение будет найдено в другом месте, [ошибки](<SWDhtml.md#h.bx3kyijtt2se>) отсутствия изображения не будет, а программа получит координаты найденного изображения и совершит [клик мышью](<SWDhtml.md#h.m6nrr53w02>) в этом месте (если результатом проверки был клик).
* Какое действие выполнить если нет изображения - относится к [обработке ошибок](<SWDhtml.md#h.bx3kyijtt2se>), может быть изменено в [локальных настройках](<SWDhtml.md#h.mxcv7zt2wndj>) команды и в скрипте. Для указания параметров использует специальный виджет [Реакция на ошибку](<SWDhtml.md#h.cbp6oij3yctx>).
* Какое действие выполнить если нет данных - относится к [обработке ошибок](<SWDhtml.md#h.bx3kyijtt2se>), может быть изменено в скрипте. Для указания параметров использует специальный виджет [Реакция на ошибку](<SWDhtml.md#h.cbp6oij3yctx>).
* Описание скрипта - справочная информация предоставляемая разработчиком [скрипта](<SWDhtml.md#h.2szjykw00q1e>).

## Режим воспроизведения

Для начала [выполнения скрипта](<SWDhtml.md#h.eqb3rxq3rr27>) из [редактора](<SWDhtml.md#h.j1dgpsh8jo7q>), нужно запустить его кнопкой [Выполнение скрипта](<SWDhtml.md#h.3b6tyd3v7v6q>), расположенной под [Списком команд скрипта](<SWDhtml.md#h.wm04hscnt7xs>). В разделе [Информация](<SWDhtml.md#h.tvffvpfyj58l>) при этом выведется сообщение Выполнение скрипта. Там же будут появляться другие сообщения информирующие пользователя о ходе выполнения.

Скрипт начнет выполняться со строки которая выбрана в списке. Если выбрана первая, пустая строка, выполнение начнется с первой [команды](<SWDhtml.md#h.mstyefmcfn3k>).

Во время [выполнения скрипта](<SWDhtml.md#h.eqb3rxq3rr27>) текущая команда подсвечивается в списке. Действия пользователя с мышью и клавиатурой, при работе скрипта, могут помешать его успешному выполнению.

Выполнение скрипта может быть прервано диалоговым окном [Остановка скрипта для диалога](<SWDhtml.md#h.z2edftevu2ta>).

Для остановки скрипта можно воспользоваться [кнопкой Стоп](<SWDhtml.md#h.3b6tyd3v7v6q>) в окне [Редактора скриптов](<SWDhtml.md#h.j1dgpsh8jo7q>) или дважды нажать левый Ctrl.

## Команды

Команды скрипта можно разбить на 3 группы в зависимости от их назначения:

* [Команды действий](<SWDhtml.md#h.yoaa2fsvqqh4>)
* [Сервисные команды](<SWDhtml.md#h.eo50ya2igvk5>)
* [Команды настроек](<SWDhtml.md#h.afqeyw1gv7ba>)

Для своей работы команды используют параметры, которые отображаются и могут быть изменены в [Редакторе команд](<SWDhtml.md#h.ktqitaev4i9m>). Параметр [Псевдоним](<SWDhtml.md#h.v9rp1twl5mms>) есть у всех команд, наличие [остальных параметров](<SWDhtml.md#h.o081ql8gmjgq>) зависит от самих команд и описано для каждой отдельно.

### Команды действий

К ним относятся команды, которые каким-либо образом взаимодействуют с интерфейсом операционной системы и программ.

В большинстве случаев они повторяют [записанные действия](<SWDhtml.md#h.11in4ibg2tt7>) пользователя. Но есть и такие, которые добавляются в скрипт вручную, при [редактировании](<SWDhtml.md#h.yuowigqqqbyt>).

#### Клик левой кнопкой мыши

Ввод: [Режим записи](<SWDhtml.md#h.11in4ibg2tt7>), [Редактор команд](<SWDhtml.md#h.ktqitaev4i9m>).

Параметры:

* два [целых числа](<SWDhtml.md#h.b8nbbqy6mtl6>) “x=”, “y=” которыми заданы координаты клика
* [изображение](<SWDhtml.md#h.j8f16470akjv>)
* [кнопка ЕЩЕ](<SWDhtml.md#h.mxcv7zt2wndj>) для настройки работы с изображением

Действие: выполнит клик левой клавишей мыши в соответствии с логикой [Проверки изображений](<SWDhtml.md#h.uk1iihhutld4>) или выполнит другие действия в соответствии с [Реакцией на ошибку](<SWDhtml.md#h.bx3kyijtt2se>).

#### Двойной щелчок мышью

Работает как команда “Клик левой кнопкой мыши”, только выполняет двойной клик левой клавишей мыши.

#### Клик правой кнопкой мыши

Работает как команда “Клик левой кнопкой мыши”, только выполняет двойной клик правой клавишей мыши.

#### Нажать клавишу

Ввод: [Режим записи](<SWDhtml.md#h.11in4ibg2tt7>), [Редактор команд](<SWDhtml.md#h.ktqitaev4i9m>).

Параметры:

* [клавиша](<SWDhtml.md#h.205fdrnkvb64>), которая должна быть нажата

Действие: имитирует нажатие (только нажимает, не [отпускает](<SWDhtml.md#h.w1lscdo7x4bb>)) выбранной клавиши.

#### Отпустить клавишу

Ввод: [Режим записи](<SWDhtml.md#h.11in4ibg2tt7>), [Редактор команд](<SWDhtml.md#h.ktqitaev4i9m>).

Параметры:

* [клавиша](<SWDhtml.md#h.205fdrnkvb64>), которая должна быть отпущена

Действие: отпускает (клавиша должна быть [нажата](<SWDhtml.md#h.iv212hv8f99b>) ранее) выбранную клавишу.

#### Вывести текст

Ввод: [Редактор команд](<SWDhtml.md#h.ktqitaev4i9m>).

Параметры:

* [текст](<SWDhtml.md#h.1zq8r0trfqao>) до 500 символов

Действие: напечатает указанный текст в месте, где установлен курсор.

#### Вывод из поля

Ввод: [Редактор команд](<SWDhtml.md#h.ktqitaev4i9m>).

Параметры:

* [имя поля](<SWDhtml.md#h.205fdrnkvb64>) в таблице ([источнике данных](<SWDhtml.md#h.l3pq1gxzrq3n>))
* к скрипту должен быть [подключен Источник данных](<SWDhtml.md#h.ql466eipl0ty>).

Действие: напечатает текст из указанного поля в месте, где установлен курсор.

#### Сочетания клавиш

Группа команд без специальных параметров.

Ввод: [Режим записи](<SWDhtml.md#h.11in4ibg2tt7>), [Редактор команд](<SWDhtml.md#h.ktqitaev4i9m>).

Параметры: без параметров.

Действие: имитирует набор на клавиатуре [Стандартных сочетаний клавиш](<SWDhtml.md#h.7jf61cy4vr68>).

### Сервисные команды

Эти придают гибкость [скрипту](<SWDhtml.md#h.2szjykw00q1e>) и добавляют новые возможности.

#### Проверка изображения

Ввод: [Режим записи](<SWDhtml.md#h.11in4ibg2tt7>), [Редактор команд](<SWDhtml.md#h.ktqitaev4i9m>).

Параметры:

* два [целых числа](<SWDhtml.md#h.b8nbbqy6mtl6>) “x=”, “y=” которыми заданы координаты центра проверяемого изображения
* [изображение](<SWDhtml.md#h.j8f16470akjv>)
* [кнопка ЕЩЕ](<SWDhtml.md#h.mxcv7zt2wndj>) для настройки работы с изображением

Действие: определит, есть ли в месте с указанными координатами требуемое [изображение](<SWDhtml.md#h.j8f16470akjv>). Не выполнит никаких действий, в соответствии с логикой [Проверки изображений](<SWDhtml.md#h.uk1iihhutld4>) или выполнит действия в соответствии с [Реакцией на ошибку](<SWDhtml.md#h.bx3kyijtt2se>).

#### Следующий элемент поля

Ввод: [Редактор команд](<SWDhtml.md#h.ktqitaev4i9m>).

Параметры:

* [имя поля](<SWDhtml.md#h.205fdrnkvb64>) в таблице (источнике данных)
* к скрипту должен быть подключен [Источник данных](<SWDhtml.md#h.l3pq1gxzrq3n>).

Действие: перемещает указатель на следующую строку (запись)  для указанного поля.

#### Цикл по полю

Ввод: [Редактор команд](<SWDhtml.md#h.ktqitaev4i9m>).

Параметры:

* [имя поля](<SWDhtml.md#h.205fdrnkvb64>) в таблице (источнике данных)
* к скрипту должен быть подключен [Источник данных](<SWDhtml.md#h.l3pq1gxzrq3n>).

Действие: служит началом блока команд, который повторяется заданное количество раз. Конец блока определяется командой [Конец цикла](<SWDhtml.md#h.zhc91ec0nwvs>). Количество итераций (повторений) зависит от количества записей (строк) в указанном поле. Блок команд выполнится для каждой записи.

#### Цикл

Ввод: [Редактор команд](<SWDhtml.md#h.ktqitaev4i9m>).

Параметры:

* [целое число](<SWDhtml.md#h.b8nbbqy6mtl6>)

Действие: служит началом блока команд, который повторяется указанное количество раз. Конец блока определяется командой [Конец цикла](<SWDhtml.md#h.zhc91ec0nwvs>).

#### Конец цикла

Ввод: [Редактор команд](<SWDhtml.md#h.ktqitaev4i9m>).

Параметры: без параметров.

Действие: служит окончанием блока команд, который повторяется заданное количество раз. Начало блока определяется командами [Цикл по полю](<SWDhtml.md#h.vbflfq8d55hy>) или [Цикл](<SWDhtml.md#h.rc4p2qf07zk2>). Для цикла по полю переводит указатель поля в [Источнике данных](<SWDhtml.md#h.l3pq1gxzrq3n>) к следующей записи. Для простого цикла меняет счетчик. После отработки последней итерации выполняются команды следующие за этой. Если команда встретится без объявленного ранее начала цикла - она будет проигнорирована.

#### Блок команд

Ввод: [Редактор команд](<SWDhtml.md#h.ktqitaev4i9m>).

Параметры:

* [имя блока](<SWDhtml.md#h.205fdrnkvb64>) (метка)

Действие: служит началом блока команд, который выполнится при переходе к его метке. Конец блока определяется командой [Конец блока](<SWDhtml.md#h.o1blymkq2kc7>). Переход к метке осуществляется командой [Выполнить](<SWDhtml.md#h.k29n479n7nig>), как [Реакция на ошибку](<SWDhtml.md#h.bx3kyijtt2se>) или из [диалогового окна](<SWDhtml.md#h.z2edftevu2ta>). Если команда встречается по ходу скрипта, блок будет обойден, осуществится переход к команде следующей за командой [Конец блока](<SWDhtml.md#h.o1blymkq2kc7>). Если [Конец блока](<SWDhtml.md#h.o1blymkq2kc7>) не будет обнаружен, то эта команда будет просто проигнорирована.

#### Конец блока

Ввод: [Редактор команд](<SWDhtml.md#h.ktqitaev4i9m>).

* Параметры: без параметров.

Действие: служит окончанием блока команд, который выполнится при переходе к его метке. Начало блока определяется командой [Блок команд](<SWDhtml.md#h.cha4mq1bkwx3>). После этой команды скрипт продолжит [выполняться](<SWDhtml.md#h.qdx7l72slmw5>) от команды вызвавшей блок. Если команда встретится без объявленного ранее начала блока - она будет проигнорирована.

#### Метка

Ввод: [Редактор команд](<SWDhtml.md#h.ktqitaev4i9m>).

Параметры:

* [имя](<SWDhtml.md#h.205fdrnkvb64>) (метка)

Действие: не выполняет действий. Служит меткой, к которой может быть совершен переход командой [Выполнить](<SWDhtml.md#h.k29n479n7nig>), как [Реакция на ошибку](<SWDhtml.md#h.bx3kyijtt2se>) или из [диалогового окна](<SWDhtml.md#h.z2edftevu2ta>).

#### Выполнить

Ввод: [Редактор команд](<SWDhtml.md#h.ktqitaev4i9m>).

Параметры:

* [имя](<SWDhtml.md#h.205fdrnkvb64>) (метка)

Действие: совершает переход к метке заданной командами [Блок команд](<SWDhtml.md#h.cha4mq1bkwx3>) или [Метка](<SWDhtml.md#h.za8bw83dekbe>).

#### Диалоговое окно

Ввод: [Редактор команд](<SWDhtml.md#h.ktqitaev4i9m>).

Параметры:

* [текст](<SWDhtml.md#h.1zq8r0trfqao>) до 500 символов

Действие: выведет [диалоговое окно](<SWDhtml.md#h.z2edftevu2ta>) с указанным текстом и будет ожидать реакции пользователя.

#### Пауза

Ввод: [Редактор команд](<SWDhtml.md#h.ktqitaev4i9m>).

Параметры:

* [число с плавающей точкой](<SWDhtml.md#h.z7hwqgyyka0f>) (секунды)

Действие: остановит [выполнение скрипта](<SWDhtml.md#h.qdx7l72slmw5>) на указанное всемя.

#### Конец скрипта

Ввод: [Редактор команд](<SWDhtml.md#h.ktqitaev4i9m>).

* Параметры: без параметров.

Действие: завершит [выполнение скрипта](<SWDhtml.md#h.eqb3rxq3rr27>). В раздел [Информация](<SWDhtml.md#h.tvffvpfyj58l>) выведет сообщение “Пользователь остановил выполнение скрипта”.

### Команды настроек

Временно меняют [настройки скрипта](<SWDhtml.md#h.fdjt0djkiwh6>) заданные по умолчанию.

#### Реакция на ошибку "Нет элемента"

Ввод: [Редактор команд](<SWDhtml.md#h.ktqitaev4i9m>).

Параметры:

* [реакция на ошибку](<SWDhtml.md#h.cbp6oij3yctx>)

Действие: изменит одноименную [настройку](<SWDhtml.md#h.fdjt0djkiwh6>) на указанную до конца [выполнения скрипта](<SWDhtml.md#h.eqb3rxq3rr27>) или до нового переназначения.

#### Реакция на ошибку "Нет данных"

Ввод: [Редактор команд](<SWDhtml.md#h.ktqitaev4i9m>).

Параметры:

* [реакция на ошибку](<SWDhtml.md#h.cbp6oij3yctx>)

Действие: изменит одноименную [настройку](<SWDhtml.md#h.fdjt0djkiwh6>) на указанную до конца [выполнения скрипта](<SWDhtml.md#h.qdx7l72slmw5>) или до нового переназначения.

# Менеджер проектов

Менеджер проектов служит для создания различных способов [запуска](<SWDhtml.md#h.qdx7l72slmw5>) [скриптов проектов](<SWDhtml.md#h.2szjykw00q1e>). Он работает только с проектами находящимися в [Рабочей папке](<SWDhtml.md#h.7ix3c5p2au58>). При каждом запуске сканирует [проекты](<SWDhtml.md#h.2szjykw00q1e>), проверяет и обновляет информацию о них в [Файле с описанием проектов](<SWDhtml.md#h.kt2wg7wyaffc>).

Автоматически генерирует [коды запуска](<SWDhtml.md#h.5blu56l3kfbw>) скриптов, позволяет редактировать их, получать [штрих-коды](<SWDhtml.md#h.5blu56l3kfbw>), создавать [ярлыки](<SWDhtml.md#h.g8smhndqepbv>) на рабочем столе для  запуска.  В Менеджере проектов предусмотрена возможность изменения [Рабочей папки](<SWDhtml.md#h.7ix3c5p2au58>), поиск и запуск скрипта с подключенным [Источником данных](<SWDhtml.md#h.l3pq1gxzrq3n>) по коду или с использованием сканера штрих-кодов.

Менеджер проектов открывается с помощью соответствующего [ярлыка](<SWDhtml.md#h.ax7z9tsy2qi1>) на рабочем столе. Также он может быть запущен через [меню](<SWDhtml.md#h.a68vby8wt2rj>) Редактора скриптов и в [Окне быстрого запуска](<SWDhtml.md#h.y0smfg36xmvl>), [кнопка](<SWDhtml.md#h.d1b20nhxn9e4>) видна, когда включен [Режим разработчика](<SWDhtml.md#h.sjfh8tnyi8gw>).

## Окно менеджера проектов

Окно [Менеджера проектов](<SWDhtml.md#h.9wpp5pdgo4bi>) состоит из Списка проектов и ряда управляющих элементов под ним.

### Список проектов

В списке отображаются все [проекты](<SWDhtml.md#h.2szjykw00q1e>) находящиеся в текущей [Рабочей папке](<SWDhtml.md#h.7ix3c5p2au58>). Каждая строка - это отдельный проект, в ней указаны: [код запуска](<SWDhtml.md#h.5blu56l3kfbw>), дата создания, дата последнего изменения, имя проекта.

Если проект имеет [Источники данных](<SWDhtml.md#h.l3pq1gxzrq3n>), то перед кодом запуска будет отображаться указатель, клик на котором (или двойной клик по строке проекта) откроет их список. Список источников отобразится под строкой проекта. В нем указаны: [код запуска](<SWDhtml.md#h.5blu56l3kfbw>) и имя файла Источника данных.

Проект в списке выбирается кликом мыши. Выбор строки файла подразумевает выбор проекта, которому он принадлежит, с подключением указанного файла в качестве [Источника данных](<SWDhtml.md#h.l3pq1gxzrq3n>).

### Элементы управления Менеджера проектов

Для выполнения действий с выбранным в [Списке проектов](<SWDhtml.md#h.oh62dgfbe09a>) проектом и некоторых других операций, служат поля ввода и кнопки расположенные под списком.

#### Номер проекта или файла данных

Поле ввода для изменения номера [проекта](<SWDhtml.md#h.2szjykw00q1e>) или источника данных, из которых формируется [Код запуска](<SWDhtml.md#h.5blu56l3kfbw>). В нем отображается двузначный номер выбранного в списке объекта, который может быть изменен пользователем. Если пользователь вводит номер который уже принадлежит другому проекту или файлу в проекте, то его номер меняется на указанный, а объект которому принадлежал этот номер, получает первый свободный номер.

Подтверждение изменения номера совершается клавишей Enter или расположенной справа кнопкой [Изменить код](<SWDhtml.md#h.o6anj9j1o3ht>).

#### Изменить код

Кнопка для подтверждения изменения [номера](<SWDhtml.md#h.6wj4lmbtuld1>) проекта или [Источника данных](<SWDhtml.md#h.l3pq1gxzrq3n>).

#### Получить штрих-код

Кнопка открывает диалоговое окно сохранения [штрих-кода](<SWDhtml.md#h.5blu56l3kfbw>) для запуска выбранного в [Списке проектов](<SWDhtml.md#h.oh62dgfbe09a>) скрипта. Его изображение будет сохранено в формате “png” в указанном месте на диске.

#### Сохранить ярлык на рабочем столе

Кнопка создает на рабочем столе ярлык для запуска выбранного в [Списке проектов](<SWDhtml.md#h.oh62dgfbe09a>) скрипта. Имя ярлыка составляется из слова “Старт “ и имени проекта с большой буквы.

#### Открыть в редакторе

Кнопка используется для перехода в [Редактора скриптов](<SWDhtml.md#h.j1dgpsh8jo7q>). Редактор открывается с загруженным [проектом](<SWDhtml.md#h.2szjykw00q1e>) и подключенным [Источником данных](<SWDhtml.md#h.l3pq1gxzrq3n>), если они были выбраны в [Списке проектов](<SWDhtml.md#h.oh62dgfbe09a>). Если проект не был выбран, то редактор загрузится с последним открытым проектом. Для открытия Редактора скриптов также может быть использовано сочетание клавиш Ctrl+E.

#### Открыть окно быстрого запуска

Кнопка совершает переход к [Окну быстрого запуска](<SWDhtml.md#h.y0smfg36xmvl>).

#### Открыть рабочую папку

Откроет текущую [Рабочую папку](<SWDhtml.md#h.7ix3c5p2au58>).

#### Выбрать рабочую папку

Откроет диалоговое окно для выбора [папки](<SWDhtml.md#h.7ix3c5p2au58>). Настройка применяется для всей программы.

#### Выполнить скрипт

Начнет [Выполнение скрипта](<SWDhtml.md#h.eqb3rxq3rr27>) с подключенным или нет [Источником данных](<SWDhtml.md#h.l3pq1gxzrq3n>) из [проекта](<SWDhtml.md#h.2szjykw00q1e>) который в данный момент выбран в [Списке проектов](<SWDhtml.md#h.oh62dgfbe09a>).

#### Поиск и запуск по коду

Поле ввода для поиска проекта по [коду запуска](<SWDhtml.md#h.5blu56l3kfbw>). Допускает ввод 4 цифр. [Проект](<SWDhtml.md#h.2szjykw00q1e>) с введенным кодом запуска выбирается в [Списке проектов](<SWDhtml.md#h.oh62dgfbe09a>) и может быть запущен клавишей Enter в окончании ввода, кнопкой [Выполнить скрипт](<SWDhtml.md#h.vk6bp6evb1qm>) или автоматически, если для ввода использовать сканер [штрих-кодов](<SWDhtml.md#h.5blu56l3kfbw>).

## Файл с описанием проектов

Файл “projects\_list.json” создается [Рабочей папке](<SWDhtml.md#h.7ix3c5p2au58>) при первом запуске [Менеджера проектов](<SWDhtml.md#h.9wpp5pdgo4bi>) с использованием этой папки в качестве [рабочей](<SWDhtml.md#h.1ft0tukrlxr>). В дальнейшем, при каждом запуске [Менеджер проектов](<SWDhtml.md#h.9wpp5pdgo4bi>) обновляет информацию в файле при обнаружении изменений в [проектах](<SWDhtml.md#h.2szjykw00q1e>) Рабочей папки.

Файл содержит информацию обо всех проектах в [Рабочей папке](<SWDhtml.md#h.7ix3c5p2au58>) и их [Источниках данных](<SWDhtml.md#h.l3pq1gxzrq3n>), хранит уникальные коды для них.

Если в [выбранной](<SWDhtml.md#h.1ft0tukrlxr>) Рабочей папке нет файла с описанием проектов, [запуск скрипта](<SWDhtml.md#h.qdx7l72slmw5>) из [Окна быстрого запуска](<SWDhtml.md#h.y0smfg36xmvl>) будет не возможен.

# Окно быстрого запуска

Окно быстрого запуска предназначено для [запуска](<SWDhtml.md#h.eqb3rxq3rr27>) [скрипта](<SWDhtml.md#h.2szjykw00q1e>) посредством сканером [штрих-кодов](<SWDhtml.md#h.5blu56l3kfbw>). Но скрипт можно запустить и вводом [кода запуска](<SWDhtml.md#h.5blu56l3kfbw>) с клавиатуры. Окно всегда отображается поверх всех окон. Оно представляет минимум функций для запуска скриптов и перехода к другим [компонентам программы](<SWDhtml.md#h.vzcd0vu5cb74>).

## Элементы управления в Окне быстрого запуска

Слева всегда отображается поле ввода кода, когда окно активно это поле имеет фокус ввода. Справа расположены 2 или 4 кнопки. Кнопки перехода в [Редактор скриптов](<SWDhtml.md#h.j1dgpsh8jo7q>) и [Менеджер проектов](<SWDhtml.md#h.9wpp5pdgo4bi>) отображаются только если включен [Режим разработчика](<SWDhtml.md#h.sjfh8tnyi8gw>).

### Поле ввода кода запуска

В поле вводится [код запуска](<SWDhtml.md#h.5blu56l3kfbw>) проекта, [скрипт](<SWDhtml.md#h.2szjykw00q1e>) которого должен быть [выполнен](<SWDhtml.md#h.eqb3rxq3rr27>). Допускает ввод 4 цифр. Скрипт может быть запущен клавишей Enter в окончании ввода, кнопкой [Выполнить скрипт](<SWDhtml.md#h.y5mvv0jda82c>) или автоматически, если для ввода использовать сканер [штрих-кодов](<SWDhtml.md#h.5blu56l3kfbw>).

### Выполнить скрипт

Начнет [Выполнение скрипта](<SWDhtml.md#h.eqb3rxq3rr27>) с подключенным или нет [Источником данных](<SWDhtml.md#h.l3pq1gxzrq3n>) из [проекта](<SWDhtml.md#h.2szjykw00q1e>), [Код запуска](<SWDhtml.md#h.5blu56l3kfbw>) которого в данный момент введен в [Поле ввода кода запуска](<SWDhtml.md#h.c6qfyilvnwy5>).

### Перейти в редактор скриптов

Кнопка не отображается если выключен [Режим разработчика](<SWDhtml.md#h.sjfh8tnyi8gw>). Однако, в любом случае, для перехода в [Редактор скриптов](<SWDhtml.md#h.j1dgpsh8jo7q>) можно воспользоваться сочетанием клавиш Ctrl+E.

Кнопка используется для перехода в [Редактора скриптов](<SWDhtml.md#h.j1dgpsh8jo7q>).

### Перейти в Менеджер проектов

Кнопка не отображается если выключен [Режим разработчика](<SWDhtml.md#h.sjfh8tnyi8gw>).

Используется для перехода в [Менеджер проектов](<SWDhtml.md#h.9wpp5pdgo4bi>).

### Закрыть

Кнопка закрывает [окно](<SWDhtml.md#h.w20pj8jixwy>), завершает программу.

***
_Created with the Personal Edition of HelpNDoc: [Full-featured multi-format Help generator](<https://www.helpndoc.com/help-authoring-tool>)_
